{"version":3,"file":"SwiperItem.js","sources":["../../src/swiper/SwiperItem.tsx"],"sourcesContent":["import React from 'react';\nimport classnames from 'classnames';\nimport useConfig from '../_util/useConfig';\nimport { SwiperProps } from './Swiper';\n\nexport interface SwiperItemProps extends SwiperProps {\n  currentIndex?: number;\n  index?: number;\n  needAnimation?: boolean;\n  childrenLength?: number;\n  getWrapAttribute?: (attr: string) => number;\n}\n\nconst CARD_SCALE = 210 / 332; // 缩放比例\nconst itemWidth = 0.415; // 依据设计稿使用t-swiper__card控制每个swiper的宽度为41.5%\n\nconst disposeIndex = (index: number, currentIndex: number, childrenLength: number) => {\n  if (currentIndex === 0 && index === childrenLength - 1) {\n    return -1;\n  }\n  if (currentIndex === childrenLength - 1 && index === 0) {\n    return childrenLength;\n  }\n  if (index < currentIndex - 1 && currentIndex - index >= childrenLength / 2) {\n    return childrenLength + 1;\n  }\n  if (index > currentIndex + 1 && index - currentIndex >= childrenLength / 2) {\n    return -2;\n  }\n\n  return index;\n};\n\nconst calculateTranslate = (index: number, currentIndex: number, parentWidth: number, inStage: boolean) => {\n  if (inStage) {\n    return (parentWidth * ((index - currentIndex) * (1 - itemWidth * CARD_SCALE) - itemWidth + 1)) / 2;\n  }\n  if (index < currentIndex) {\n    return (-itemWidth * (1 + CARD_SCALE) * parentWidth) / 2;\n  }\n  return ((2 + itemWidth * (CARD_SCALE - 1)) * parentWidth) / 2;\n};\n\nconst getZindex = (isActivity, inStage) => {\n  if (isActivity) {\n    return 2;\n  }\n  if (inStage) {\n    return 1;\n  }\n  return 0;\n};\n\nconst SwiperItem = (props: SwiperItemProps) => {\n  const {\n    children,\n    currentIndex,\n    index,\n    animation,\n    duration = 300,\n    needAnimation,\n    type = 'default',\n    childrenLength,\n    getWrapAttribute,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  const getSwiperItemStyle = () => {\n    if (animation === 'fade') {\n      return {\n        opacity: currentIndex === index ? 1 : 0,\n        transition: needAnimation ? `opacity ${duration / 1000}s` : '',\n      };\n    }\n    if (type === 'card') {\n      const wrapWidth = getWrapAttribute('offsetWidth');\n      const translateIndex =\n        index !== currentIndex && childrenLength > 2 ? disposeIndex(index, currentIndex, childrenLength) : index;\n      const inStage = Math.round(Math.abs(translateIndex - currentIndex)) <= 1;\n      const translate = calculateTranslate(translateIndex, currentIndex, wrapWidth, inStage).toFixed(2);\n      const isActivity = translateIndex === currentIndex;\n      const zIndex = getZindex(isActivity, inStage);\n      return {\n        msTransform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        WebkitTransform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        transform: `translateX(${translate}px) scale(${isActivity ? 1 : CARD_SCALE})`,\n        transition: `transform ${duration / 1000}s ease`,\n        zIndex,\n      };\n    }\n    return {};\n  };\n\n  return (\n    <div\n      className={classnames(`${classPrefix}-swiper__container__item`, {\n        [`${classPrefix}-swiper__card`]: type === 'card',\n        [`${classPrefix}-is-active`]: type === 'card' && index === currentIndex,\n        [`${classPrefix}-swiper__fade`]: animation === 'fade',\n      })}\n      style={getSwiperItemStyle()}\n    >\n      {children}\n    </div>\n  );\n};\n\nSwiperItem.displayName = 'SwiperItem';\n\nexport default SwiperItem;\n"],"names":["CARD_SCALE","itemWidth","disposeIndex","index","currentIndex","childrenLength","calculateTranslate","parentWidth","inStage","getZindex","isActivity","SwiperItem","props","children","animation","duration","needAnimation","type","getWrapAttribute","useConfig","classPrefix","getSwiperItemStyle","opacity","transition","wrapWidth","translateIndex","Math","round","abs","translate","toFixed","zIndex","msTransform","WebkitTransform","transform","React","createElement","className","classnames","style","displayName"],"mappings":"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"}