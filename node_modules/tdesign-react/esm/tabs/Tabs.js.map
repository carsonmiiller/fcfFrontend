{"version":3,"file":"Tabs.js","sources":["../../src/tabs/Tabs.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport { TabValue, TdTabsProps } from './type';\nimport forwardRefWithStatics from '../_util/forwardRefWithStatics';\nimport TabNav from './TabNav';\nimport { useTabClass } from './useTabClass';\nimport TabPanel from './TabPanel';\nimport { StyledProps } from '../common';\nimport { tabsDefaultProps } from './defaultProps';\n\nexport interface TabsProps extends TdTabsProps, StyledProps {\n  children?: React.ReactNode;\n}\n\nconst Tabs = forwardRefWithStatics(\n  (props: TabsProps, ref) => {\n    const { children, placement, onRemove, value: tabValue, onChange, className, style } = props;\n    let { defaultValue } = props;\n\n    // 样式工具引入\n    const { tdTabsClassPrefix, tdTabsClassGenerator, tdClassGenerator } = useTabClass();\n\n    const itemList = React.Children.map(children, (child: any) => {\n      if (child && child.type === TabPanel) {\n        return child.props;\n      }\n      return null;\n    });\n\n    // 当未设置默认值时，默认选中第一个。\n    if (defaultValue === undefined && Array.isArray(itemList) && itemList.length !== 0) {\n      defaultValue = itemList[0].value;\n    }\n\n    const [value, setValue] = useState<TabValue>(defaultValue);\n\n    useEffect(() => {\n      tabValue !== undefined && setValue(tabValue);\n    }, [tabValue]);\n\n    const handleChange = (v) => {\n      if (tabValue === undefined) {\n        setValue(v);\n      }\n      onChange?.(v);\n    };\n\n    const handleClickTab = (v) => {\n      if (tabValue === undefined) {\n        setValue(v);\n      }\n    };\n\n    const renderHeader = () => (\n      <div className={classNames(tdTabsClassGenerator('header'), tdClassGenerator(`is-${placement}`))}>\n        <TabNav\n          {...props}\n          activeValue={value}\n          onRemove={onRemove}\n          itemList={itemList}\n          tabClick={handleClickTab}\n          onChange={handleChange}\n        />\n      </div>\n    );\n\n    return (\n      <div ref={ref} className={classNames(tdTabsClassPrefix, className)} style={style}>\n        {placement !== 'bottom' ? renderHeader() : null}\n        <div className={classNames(tdTabsClassGenerator('content'), tdClassGenerator(`is-${placement}`))}>\n          {React.Children.map(children, (child: any) => {\n            if (child && child.type === TabPanel) {\n              if (child.props.value === value) {\n                return child;\n              }\n              if (child.props.destroyOnHide === false) {\n                return <TabPanel style={{ display: 'none' }}>{child.props.children}</TabPanel>;\n              }\n            }\n            return null;\n          })}\n        </div>\n        {placement === 'bottom' ? renderHeader() : null}\n      </div>\n    );\n  },\n  { TabPanel },\n);\n\nTabs.displayName = 'Tabs';\nTabs.defaultProps = tabsDefaultProps;\n\nexport default Tabs;\n"],"names":["Tabs","forwardRefWithStatics","props","ref","children","placement","onRemove","tabValue","value","onChange","className","style","defaultValue","useTabClass","tdTabsClassPrefix","tdTabsClassGenerator","tdClassGenerator","itemList","React","Children","map","child","type","TabPanel","Array","isArray","length","useState","setValue","useEffect","handleChange","v","handleClickTab","renderHeader","createElement","classNames","TabNav","activeValue","tabClick","destroyOnHide","display","displayName","defaultProps","tabsDefaultProps"],"mappings":"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"}