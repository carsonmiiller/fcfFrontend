{"version":3,"file":"Popup.js","sources":["../../src/popup/Popup.tsx"],"sourcesContent":["import React, {\n  forwardRef,\n  CSSProperties,\n  useState,\n  cloneElement,\n  isValidElement,\n  useMemo,\n  useCallback,\n  useRef,\n  useEffect,\n} from 'react';\nimport { CSSTransition } from 'react-transition-group';\nimport classNames from 'classnames';\nimport { usePopper } from 'react-popper';\nimport { Placement } from '@popperjs/core';\nimport { StyledProps } from '../common';\nimport useControlled from '../hooks/useControlled';\nimport useAnimation from '../_util/useAnimation';\nimport useConfig from '../_util/useConfig';\nimport composeRefs from '../_util/composeRefs';\nimport { TdPopupProps } from './type';\nimport Portal from '../common/Portal';\nimport useTriggerProps from './hooks/useTriggerProps';\nimport getTransitionParams from './utils/getTransitionParams';\nimport useMutationObserver from '../_util/useMutationObserver';\nimport useWindowSize from '../_util/useWindowSize';\nimport { popupDefaultProps } from './defaultProps';\n\nexport interface PopupProps extends TdPopupProps, StyledProps {\n  // 是否触发展开收起动画，内部下拉式组件使用\n  expandAnimation?: boolean;\n  // 初始化popper的可定制option\n  popperModifiers?: Array<{ name: string; options: Object }>;\n  updateScrollTop?: (content: HTMLDivElement) => void;\n}\n\nfunction getPopperPlacement(placement: TdPopupProps['placement']) {\n  return placement.replace(/-(left|top)$/, '-start').replace(/-(right|bottom)$/, '-end') as Placement;\n}\n\nconst Popup = forwardRef((props: PopupProps, ref: React.Ref<HTMLDivElement>) => {\n  const {\n    trigger,\n    content,\n    placement,\n    attach,\n    showArrow,\n    destroyOnClose,\n    className,\n    style,\n    overlayClassName,\n    overlayStyle,\n    triggerElement,\n    children = triggerElement,\n    disabled,\n    zIndex,\n    onVisibleChange,\n    onScroll,\n    expandAnimation,\n    popperModifiers = [],\n    updateScrollTop,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  // 全局配置\n  const { keepExpand, keepFade } = useAnimation();\n\n  const [visible, setVisible] = useControlled(props, 'visible', onVisibleChange);\n\n  const { height: windowHeight, width: windowWidth } = useWindowSize();\n\n  // refs\n  const [triggerRef, setTriggerRef] = useState<HTMLElement>(null);\n  const [overlayRef, setOverlayRef] = useState<HTMLDivElement>(null);\n\n  const contentRef = useRef<HTMLDivElement>(null);\n  const referenceRef = useRef<HTMLDivElement>(null);\n  const popupRef = useRef(null);\n\n  const popperRef = useRef(null);\n  const portalRef = useRef(null);\n\n  // 展开时候动态判断上下左右翻转\n  const onPopperFirstUpdate = useCallback((state) => {\n    const referenceElmRect = referenceRef.current.getBoundingClientRect();\n    const { top: referenceElmTop, left: referenceElmLeft, bottom, right } = referenceElmRect;\n    const referenceElmBottom = window.innerHeight - bottom;\n    const referenceElmRight = window.innerWidth - right;\n\n    const { offsetHeight: contentOffsetHeight, offsetWidth: contentOffsetWidth } = contentRef.current;\n\n    let newPlacement = state.options.placement;\n    // 底部不够向上翻转\n    if (referenceElmBottom < contentOffsetHeight && referenceElmTop >= contentOffsetHeight) {\n      newPlacement = state.options.placement.replace('bottom', 'top');\n    }\n    // 顶部不够向下翻转\n    if (referenceElmTop < contentOffsetHeight && referenceElmBottom >= contentOffsetHeight) {\n      newPlacement = state.options.placement.replace('top', 'bottom');\n    }\n    // 左侧不够向右翻转\n    if (referenceElmLeft < contentOffsetWidth && referenceElmRight >= contentOffsetWidth) {\n      newPlacement = state.options.placement.replace('left', 'right');\n    }\n    // 右侧不够向左翻转\n    if (referenceElmRight < contentOffsetWidth && referenceElmLeft >= contentOffsetWidth) {\n      newPlacement = state.options.placement.replace('right', 'left');\n    }\n    Object.assign(state.options, { ...state.options, placement: newPlacement });\n    popperRef.current.update();\n  }, []);\n\n  const options = useMemo(\n    () => ({\n      placement: getPopperPlacement(placement),\n      onFirstUpdate: onPopperFirstUpdate,\n      modifiers: popperModifiers,\n    }),\n    [onPopperFirstUpdate, placement, popperModifiers],\n  );\n\n  popperRef.current = usePopper(triggerRef, overlayRef, options);\n\n  const { styles, attributes } = popperRef.current;\n  const defaultStyles = useMemo(() => {\n    if (triggerRef && typeof overlayStyle === 'function') return { ...overlayStyle(triggerRef, overlayRef) };\n    return { ...overlayStyle };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [overlayStyle, triggerRef, overlayRef, visible]);\n\n  // 设置 style 决定展示与隐藏\n  const overlayVisibleStyle: CSSProperties = defaultStyles;\n\n  const triggerNodeTemp = useMemo(() => {\n    const [triggerChildNode] = React.Children.toArray(children);\n\n    if (React.Children.count(children) === 1 && isValidElement(triggerChildNode)) {\n      return triggerChildNode;\n    }\n    return <span className={`${classPrefix}-trigger`}>{children}</span>;\n  }, [children, classPrefix]);\n\n  const [triggerProps, popupProps] = useTriggerProps(\n    { current: overlayRef },\n    { current: triggerRef },\n    [trigger],\n    visible,\n    setVisible,\n    disabled,\n    triggerNodeTemp,\n  );\n\n  // 代理 trigger 的 ref\n  const triggerNode = cloneElement(triggerNodeTemp, {\n    ref: composeRefs((triggerNodeTemp as any).ref, setTriggerRef),\n    ...triggerProps,\n  });\n\n  const handleExited = () => {\n    if (!destroyOnClose) {\n      portalRef.current.style.display = 'none';\n    }\n  };\n  const handleEnter = () => {\n    if (!destroyOnClose) {\n      portalRef.current.style.display = 'block';\n    }\n  };\n\n  // 监听 trigger 节点或内容变化动态更新 popup 定位\n  useMutationObserver(triggerRef, () => {\n    popperRef.current.update?.();\n  });\n  useEffect(() => {\n    popperRef.current.update?.();\n  }, [content, visible, windowHeight, windowWidth]);\n\n  useEffect(() => {\n    if (visible && overlayRef) {\n      updateScrollTop?.(contentRef?.current);\n    }\n  }, [visible, overlayRef, updateScrollTop]);\n\n  // 初次不渲染.\n  const portal =\n    visible || overlayRef ? (\n      <CSSTransition\n        appear\n        in={visible}\n        timeout={180}\n        nodeRef={popupRef}\n        unmountOnExit={destroyOnClose}\n        onEnter={handleEnter}\n        onExited={handleExited}\n      >\n        <Portal triggerNode={triggerRef} attach={attach} ref={portalRef}>\n          <CSSTransition\n            appear\n            timeout={0}\n            in={visible}\n            nodeRef={popupRef}\n            {...getTransitionParams({\n              classPrefix,\n              expandAnimation: expandAnimation && keepExpand,\n              fadeAnimation: keepFade,\n            })}\n          >\n            <div\n              ref={composeRefs(setOverlayRef, ref, popupRef)}\n              style={{ ...styles.popper, zIndex }}\n              className={`${classPrefix}-popup`}\n              {...attributes.popper}\n              {...popupProps}\n            >\n              <div\n                className={classNames(\n                  `${classPrefix}-popup__content`,\n                  {\n                    [`${classPrefix}-popup__content--arrow`]: showArrow,\n                  },\n                  overlayClassName,\n                )}\n                style={overlayVisibleStyle}\n                ref={contentRef}\n                onScroll={(e) => onScroll?.({ e: e as React.WheelEvent<HTMLDivElement> })}\n              >\n                {showArrow ? <div style={styles.arrow} className={`${classPrefix}-popup__arrow`} /> : null}\n                {content}\n              </div>\n            </div>\n          </CSSTransition>\n        </Portal>\n      </CSSTransition>\n    ) : null;\n\n  return (\n    <div className={classNames(`${classPrefix}-popup__reference`, className)} style={style} ref={referenceRef}>\n      {triggerNode}\n      {portal}\n    </div>\n  );\n});\n\nPopup.displayName = 'Popup';\nPopup.defaultProps = popupDefaultProps;\n\nexport default Popup;\n"],"names":["getPopperPlacement","placement","replace","Popup","forwardRef","props","ref","trigger","content","attach","showArrow","destroyOnClose","className","style","overlayClassName","overlayStyle","triggerElement","children","disabled","zIndex","onVisibleChange","onScroll","expandAnimation","popperModifiers","updateScrollTop","useConfig","classPrefix","useAnimation","keepExpand","keepFade","useControlled","visible","setVisible","useWindowSize","windowHeight","height","windowWidth","width","useState","triggerRef","setTriggerRef","overlayRef","setOverlayRef","contentRef","useRef","referenceRef","popupRef","popperRef","portalRef","onPopperFirstUpdate","useCallback","state","referenceElmRect","current","getBoundingClientRect","referenceElmTop","top","referenceElmLeft","left","bottom","right","referenceElmBottom","window","innerHeight","referenceElmRight","innerWidth","contentOffsetHeight","offsetHeight","contentOffsetWidth","offsetWidth","newPlacement","options","Object","assign","update","useMemo","onFirstUpdate","modifiers","usePopper","styles","attributes","defaultStyles","overlayVisibleStyle","triggerNodeTemp","React","Children","toArray","triggerChildNode","count","isValidElement","createElement","useTriggerProps","triggerProps","popupProps","triggerNode","cloneElement","composeRefs","handleExited","display","handleEnter","useMutationObserver","useEffect","portal","CSSTransition","appear","timeout","nodeRef","unmountOnExit","onEnter","onExited","Portal","getTransitionParams","fadeAnimation","popper","classNames","e","arrow","displayName","defaultProps","popupDefaultProps"],"mappings":"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"}