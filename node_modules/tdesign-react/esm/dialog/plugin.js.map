{"version":3,"file":"plugin.js","sources":["../../src/dialog/plugin.tsx"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport DialogComponent, { DialogProps } from './Dialog';\n\nimport { getAttach } from '../_util/dom';\nimport { DialogOptions, DialogMethod, DialogConfirmMethod, DialogAlertMethod, DialogInstance } from './type';\n\nexport interface DialogPluginType extends DialogMethod {\n  alert?: DialogAlertMethod;\n  confirm?: DialogConfirmMethod;\n}\n\nconst createDialog: DialogPluginType = (props: DialogOptions): DialogInstance => {\n  const dialogRef = React.createRef<DialogInstance>();\n  const options = { ...props };\n  const fragment = document.createDocumentFragment();\n\n  ReactDOM.render(\n    <DialogComponent {...(options as DialogProps)} visible={true} ref={dialogRef} isPlugin />,\n    fragment,\n    () => {\n      (document.activeElement as HTMLElement).blur();\n    },\n  );\n  const container = getAttach(options.attach);\n  if (container) {\n    container.appendChild(fragment);\n  } else {\n    console.error('attach is not exist');\n  }\n\n  const dialogNode: DialogInstance = {\n    show: () => {\n      container.appendChild(fragment);\n      dialogRef.current?.show();\n    },\n    hide: () => {\n      dialogRef.current?.destroy();\n    },\n    update: (updateOptions: DialogOptions) => {\n      dialogRef.current?.update(updateOptions);\n    },\n    destroy: () => {\n      dialogRef.current?.destroy();\n    },\n  };\n  return dialogNode;\n};\n\nconst confirm: DialogConfirmMethod = (props: DialogOptions) => createDialog(props);\n\nconst alert: DialogAlertMethod = (props: Omit<DialogOptions, 'confirmBtn'>) => {\n  const options = { ...props };\n  options.cancelBtn = null;\n  return createDialog(options);\n};\n\ncreateDialog.alert = alert;\ncreateDialog.confirm = confirm;\n\nexport const DialogPlugin = createDialog;\n"],"names":["createDialog","props","dialogRef","React","createRef","options","fragment","document","createDocumentFragment","ReactDOM","render","createElement","DialogComponent","visible","ref","isPlugin","activeElement","blur","container","getAttach","attach","appendChild","console","error","dialogNode","show","current","hide","destroy","update","updateOptions","confirm","alert","cancelBtn","DialogPlugin"],"mappings":"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"}