{"version":3,"file":"useDisableDate.js","sources":["../../../src/date-picker/hooks/useDisableDate.ts"],"sourcesContent":["import dayjs from 'dayjs';\nimport isObject from 'lodash/isObject';\nimport type { TdDatePickerProps, TdDateRangePickerProps } from '../type';\n\nexport interface disableDateProps {\n  disableDate?: TdDatePickerProps['disableDate'] | TdDateRangePickerProps['disableDate'];\n  format?: TdDatePickerProps['format'];\n  mode?: TdDatePickerProps['mode'];\n  start?: Date;\n  end?: Date;\n}\n\nexport default function useDisableDate(props: disableDateProps) {\n  const { disableDate, format, mode, start, end } = props;\n\n  return {\n    disableDate: (value: Date) => !isEnabled({ disableDate, format, mode, value }),\n    minDate: isObject(disableDate) && 'before' in disableDate ? new Date(disableDate.before) : start,\n    maxDate: isObject(disableDate) && 'after' in disableDate ? new Date(disableDate.after) : end,\n  };\n}\n\nfunction isEnabled(props): boolean {\n  const { disableDate, value, format, mode } = props;\n\n  if (!disableDate) return true;\n\n  let isEnabled = true;\n  // 值类型为 Function 则表示返回值为 true 的日期会被禁用\n  if (typeof disableDate === 'function') {\n    return !disableDate(value);\n  }\n\n  // 禁用日期，示例：['A', 'B'] 表示日期 A 和日期 B 会被禁用。\n  if (Array.isArray(disableDate)) {\n    let isIncludes = false;\n    const formatedDisabledDate = disableDate.map((item: string) => dayjs(item, format));\n    formatedDisabledDate.forEach((item) => {\n      if (item.isSame(dayjs(value))) {\n        isIncludes = true;\n      }\n    });\n    return !isIncludes;\n  }\n\n  // { from: 'A', to: 'B' } 表示在 A 到 B 之间的日期会被禁用。\n  const { from, to, before, after } = disableDate;\n  if (from && to) {\n    const compareMin = dayjs(new Date(from));\n    const compareMax = dayjs(new Date(to));\n\n    return !dayjs(value).isBetween(compareMin, compareMax, mode, '[]');\n  }\n\n  const min = before ? new Date(before) : null;\n  const max = after ? new Date(after) : null;\n\n  // { before: 'A', after: 'B' } 表示在 A 之前和在 B 之后的日期都会被禁用。\n  if (max && min) {\n    const compareMin = dayjs(new Date(min));\n    const compareMax = dayjs(new Date(max));\n\n    isEnabled = dayjs(value).isBetween(compareMin, compareMax, mode, '[]');\n  } else if (min) {\n    const compareMin = dayjs(new Date(min));\n    isEnabled = !dayjs(value).isBefore(compareMin, mode);\n  } else if (max) {\n    const compareMax = dayjs(new Date(max));\n    isEnabled = !dayjs(value).isAfter(compareMax, mode);\n  }\n  return isEnabled;\n}\n"],"names":["useDisableDate","props","disableDate","format","mode","start","end","value","isEnabled","minDate","isObject","Date","before","maxDate","after","isEnabled2","Array","isArray","isIncludes","formatedDisabledDate","map","item","dayjs","forEach","isSame","from","to","compareMin","compareMax","isBetween","min","max","isBefore","isAfter"],"mappings":"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"}