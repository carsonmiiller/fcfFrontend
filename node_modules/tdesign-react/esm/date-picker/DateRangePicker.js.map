{"version":3,"file":"DateRangePicker.js","sources":["../../src/date-picker/DateRangePicker.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport dayjs from 'dayjs';\nimport useConfig from '../_util/useConfig';\nimport { StyledProps } from '../common';\nimport { TdDateRangePickerProps } from './type';\nimport { RangeInputPopup } from '../range-input';\nimport DateRangePickerPanel from './panel/DateRangePickerPanel';\nimport useRange from './hooks/useRange';\nimport useFormat from './hooks/useFormat';\nimport { subtractMonth, addMonth, extractTimeObj } from '../_common/js/date-picker/utils-new';\nimport { dateRangePickerDefaultProps } from './defaultProps';\n\nexport interface DateRangePickerProps extends TdDateRangePickerProps, StyledProps {}\n\nconst DateRangePicker = forwardRef<HTMLDivElement, DateRangePickerProps>((props, ref) => {\n  const { classPrefix, datePicker: globalDatePickerConfig } = useConfig();\n\n  const {\n    className,\n    style,\n    disabled,\n    mode,\n    enableTimePicker,\n    disableDate,\n    firstDayOfWeek = globalDatePickerConfig.firstDayOfWeek,\n    presets,\n    timePickerProps,\n    onPick,\n  } = props;\n\n  const {\n    inputValue,\n    popupVisible,\n    rangeInputProps,\n    popupProps,\n    value,\n    year,\n    month,\n    timeValue,\n    activeIndex,\n    isHoverCell,\n    setActiveIndex,\n    onChange,\n    setIsHoverCell,\n    setInputValue,\n    setPopupVisible,\n    setTimeValue,\n    setYear,\n    setMonth,\n    isFirstValueSelected,\n    setIsFirstValueSelected,\n    cacheValue,\n    setCacheValue,\n  } = useRange(props);\n\n  const { formatTime, formatDate, isValidDate, format, timeFormat } = useFormat({\n    mode,\n    value,\n    enableTimePicker,\n    format: props.format,\n    valueType: props.valueType,\n  });\n\n  // 记录面板是否选中过\n  const [isSelected, setIsSelected] = useState(false);\n\n  useEffect(() => {\n    // 面板展开重置数据\n    if (popupVisible) {\n      setIsSelected(false);\n      setIsFirstValueSelected(false);\n      setCacheValue(formatDate(value || []));\n      setTimeValue(formatTime(value || [dayjs().format(timeFormat), dayjs().format(timeFormat)]));\n    }\n    // eslint-disable-next-line\n  }, [value, popupVisible]);\n\n  // 日期 hover\n  function onCellMouseEnter(date: Date) {\n    setIsHoverCell(true);\n    const nextValue = [...inputValue];\n    nextValue[activeIndex] = formatDate(date);\n    setInputValue(nextValue);\n  }\n\n  // 日期 leave\n  function onCellMouseLeave() {\n    setIsHoverCell(false);\n    setInputValue(cacheValue);\n  }\n\n  // 日期点击\n  function onCellClick(date: Date, { e, partial }) {\n    onPick?.(date, { e, partial });\n\n    setIsHoverCell(false);\n    setIsSelected(true);\n\n    const nextValue = [...inputValue];\n    nextValue[activeIndex] = formatDate(date);\n    setCacheValue(nextValue);\n    setInputValue(nextValue);\n\n    // date 模式自动切换年月\n    if (mode === 'date') {\n      // 选择了不属于面板中展示月份的日期\n      const partialIndex = partial === 'start' ? 0 : 1;\n      const isAdditional = dayjs(date).month() !== month[partialIndex];\n      if (isAdditional) {\n        // 保证左侧时间小于右侧\n        if (activeIndex === 0) setMonth([dayjs(date).month(), Math.min(dayjs(date).month() + 1, 11)]);\n        if (activeIndex === 1) setMonth([Math.max(dayjs(date).month() - 1, 0), dayjs(date).month()]);\n      }\n    }\n\n    // 有时间选择器走 confirm 逻辑\n    if (enableTimePicker) return;\n\n    // 确保两端都是有效值\n    const notValidIndex = nextValue.findIndex((v) => !v || !isValidDate(v));\n\n    // 首次点击不关闭、确保两端都有有效值并且无时间选择器时点击后自动关闭\n    if (notValidIndex === -1 && nextValue.length === 2 && !enableTimePicker && isFirstValueSelected) {\n      onChange(formatDate(nextValue, 'valueType'), {\n        dayjsValue: nextValue.map((v) => dayjs(v)),\n        trigger: 'pick',\n      });\n      setIsFirstValueSelected(false);\n      setPopupVisible(false);\n    } else if (notValidIndex !== -1) {\n      setActiveIndex(notValidIndex);\n    } else {\n      setActiveIndex(activeIndex ? 0 : 1);\n    }\n\n    // 记录选中一次\n    setIsFirstValueSelected(true);\n  }\n\n  // 头部快速切换\n  function onJumperClick(flag: number, { partial }) {\n    const partialIndex = partial === 'start' ? 0 : 1;\n\n    const monthCountMap = { date: 1, month: 12, year: 120 };\n    const monthCount = monthCountMap[mode] || 0;\n    const current = new Date(year[partialIndex], month[partialIndex]);\n\n    let next = null;\n    if (flag === -1) {\n      next = subtractMonth(current, monthCount);\n    } else if (flag === 0) {\n      next = new Date();\n    } else if (flag === 1) {\n      next = addMonth(current, monthCount);\n    }\n\n    const nextYear = [...year];\n    nextYear[partialIndex] = next.getFullYear();\n    const nextMonth = [...month];\n    nextMonth[partialIndex] = next.getMonth();\n\n    // 保证左侧时间不大于右侧\n    if (partialIndex === 0) {\n      nextYear[1] = Math.max(nextYear[0], nextYear[1]);\n\n      if (nextYear[0] === nextYear[1]) {\n        nextMonth[1] = Math.max(nextMonth[0], nextMonth[1]);\n      }\n    }\n\n    // 保证左侧时间不大于右侧\n    if (partialIndex === 1) {\n      nextYear[0] = Math.min(nextYear[0], nextYear[1]);\n\n      if (nextYear[0] === nextYear[1]) {\n        nextMonth[0] = Math.min(nextMonth[0], nextMonth[1]);\n      }\n    }\n\n    setYear(nextYear);\n    setMonth(nextMonth);\n  }\n\n  // time-picker 点击\n  function onTimePickerChange(val: string) {\n    const { hours, minutes, seconds, milliseconds, meridiem } = extractTimeObj(val);\n\n    const nextInputValue = [...inputValue];\n    const changedInputValue = inputValue[activeIndex];\n    const currentDate = !dayjs(changedInputValue, format).isValid()\n      ? dayjs().year(year[activeIndex]).month(month[activeIndex])\n      : dayjs(changedInputValue, format);\n    // am pm 12小时制转化 24小时制\n    let nextHours = hours;\n    if (/am/i.test(meridiem) && nextHours === 12) nextHours -= 12;\n    if (/pm/i.test(meridiem) && nextHours < 12) nextHours += 12;\n\n    const nextDate = currentDate.hour(nextHours).minute(minutes).second(seconds).millisecond(milliseconds).toDate();\n    nextInputValue[activeIndex] = nextDate;\n\n    const nextTimeValue = [...timeValue];\n    nextTimeValue[activeIndex] = val;\n    setTimeValue(nextTimeValue);\n\n    setIsSelected(true);\n    setInputValue(formatDate(nextInputValue));\n    setCacheValue(formatDate(nextInputValue));\n  }\n\n  // 确定\n  function onConfirmClick() {\n    const nextValue = [...inputValue];\n\n    const notValidIndex = nextValue.findIndex((v) => !v || !isValidDate(v));\n\n    // 首次点击不关闭、确保两端都有有效值并且无时间选择器时点击后自动关闭\n    if (notValidIndex === -1 && nextValue.length === 2 && isFirstValueSelected) {\n      onChange(formatDate(nextValue, 'valueType'), {\n        dayjsValue: nextValue.map((v) => dayjs(v)),\n        trigger: 'confirm',\n      });\n      setYear(nextValue.map((v) => dayjs(v, format).year()));\n      setMonth(nextValue.map((v) => dayjs(v, format).month()));\n      setPopupVisible(false);\n    } else if (notValidIndex !== -1) {\n      setActiveIndex(notValidIndex);\n    } else {\n      setActiveIndex(activeIndex ? 0 : 1);\n    }\n\n    // 记录选中一次\n    setIsFirstValueSelected(true);\n  }\n\n  // 预设\n  function onPresetClick(preset: any) {\n    let presetValue = preset;\n    if (typeof preset === 'function') {\n      presetValue = preset();\n    }\n    if (!Array.isArray(presetValue)) {\n      console.error(`preset: ${preset} 预设值必须是数组!`);\n    } else {\n      onChange(formatDate(presetValue, 'valueType'), {\n        dayjsValue: presetValue.map((p) => dayjs(p)),\n        trigger: 'preset',\n      });\n      setPopupVisible(false);\n    }\n  }\n\n  function onYearChange(nextVal: number, { partial }) {\n    let partialIndex = partial === 'start' ? 0 : 1;\n    if (enableTimePicker) partialIndex = activeIndex;\n\n    const nextYear = [...year];\n    nextYear[partialIndex] = nextVal;\n    // 保证左侧时间不大于右侧\n    if (partialIndex === 0) nextYear[1] = Math.max(nextYear[0], nextYear[1]);\n    if (partialIndex === 1) nextYear[0] = Math.min(nextYear[0], nextYear[1]);\n\n    setYear(nextYear);\n  }\n\n  function onMonthChange(nextVal: number, { partial }) {\n    let partialIndex = partial === 'start' ? 0 : 1;\n    if (enableTimePicker) partialIndex = activeIndex;\n\n    const nextMonth = [...month];\n    nextMonth[partialIndex] = nextVal;\n    // 保证左侧时间不大于右侧\n    if (year[0] === year[1]) {\n      if (partialIndex === 0) nextMonth[1] = Math.max(nextMonth[0], nextMonth[1]);\n      if (partialIndex === 1) nextMonth[0] = Math.min(nextMonth[0], nextMonth[1]);\n    }\n\n    setMonth(nextMonth);\n  }\n\n  const panelProps = {\n    hoverValue: isHoverCell ? inputValue : [],\n    value: isSelected ? cacheValue : value,\n    isFirstValueSelected,\n    year,\n    month,\n    mode,\n    format,\n    presets,\n    timeValue,\n    disableDate,\n    firstDayOfWeek,\n    timePickerProps,\n    enableTimePicker,\n    activeIndex,\n    onCellClick,\n    onCellMouseEnter,\n    onCellMouseLeave,\n    onJumperClick,\n    onConfirmClick,\n    onPresetClick,\n    onYearChange,\n    onMonthChange,\n    onTimePickerChange,\n  };\n\n  return (\n    <div className={classNames(`${classPrefix}-date-range-picker`, className)} style={style} ref={ref}>\n      <RangeInputPopup\n        disabled={disabled}\n        inputValue={inputValue}\n        popupProps={popupProps}\n        rangeInputProps={rangeInputProps}\n        popupVisible={popupVisible}\n        panel={<DateRangePickerPanel {...panelProps} />}\n      />\n    </div>\n  );\n});\n\nDateRangePicker.displayName = 'DateRangePicker';\nDateRangePicker.defaultProps = dateRangePickerDefaultProps;\n\nexport default DateRangePicker;\n"],"names":["DateRangePicker","forwardRef","props","ref","useConfig","classPrefix","globalDatePickerConfig","datePicker","className","style","disabled","mode","enableTimePicker","disableDate","firstDayOfWeek","presets","timePickerProps","onPick","useRange","inputValue","popupVisible","rangeInputProps","popupProps","value","year","month","timeValue","activeIndex","isHoverCell","setActiveIndex","onChange","setIsHoverCell","setInputValue","setPopupVisible","setTimeValue","setYear","setMonth","isFirstValueSelected","setIsFirstValueSelected","cacheValue","setCacheValue","useFormat","format","valueType","formatTime","formatDate","isValidDate","timeFormat","useState","isSelected","setIsSelected","useEffect","dayjs","onCellMouseEnter","date","nextValue","onCellMouseLeave","onCellClick","e","partial","partialIndex","isAdditional","Math","min","max","notValidIndex","findIndex","v","length","dayjsValue","map","trigger","onJumperClick","flag","monthCountMap","monthCount","current","Date","next","subtractMonth","addMonth","nextYear","getFullYear","nextMonth","getMonth","onTimePickerChange","val","extractTimeObj","hours","minutes","seconds","milliseconds","meridiem","nextInputValue","changedInputValue","currentDate","isValid","nextHours","test","nextDate","hour","minute","second","millisecond","toDate","nextTimeValue","onConfirmClick","onPresetClick","preset","presetValue","Array","isArray","console","error","p","onYearChange","nextVal","onMonthChange","panelProps","hoverValue","React","createElement","classNames","RangeInputPopup","panel","DateRangePickerPanel","displayName","defaultProps","dateRangePickerDefaultProps"],"mappings":"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"}