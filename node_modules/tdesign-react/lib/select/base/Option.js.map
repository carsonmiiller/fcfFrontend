{"version":3,"file":"Option.js","sources":["../../../src/select/base/Option.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\nimport isNumber from 'lodash/isNumber';\nimport isString from 'lodash/isString';\nimport get from 'lodash/get';\n\nimport useConfig from '../../_util/useConfig';\nimport useRipple from '../../_util/useRipple';\nimport { StyledProps } from '../../common';\nimport { SelectValue, TdOptionProps, TdSelectProps, SelectKeysType } from '../type';\n\n/**\n * Option 组件属性\n */\nexport interface SelectOptionProps\n  extends StyledProps,\n    TdOptionProps,\n    Pick<TdSelectProps, 'size' | 'multiple' | 'max'> {\n  selectedValue?: SelectValue;\n  children?: React.ReactNode;\n  onSelect?: (\n    value: string | number,\n    context: { label?: string; selected?: boolean; event: React.MouseEvent; restData?: Record<string, any> },\n  ) => void;\n  restData?: Record<string, any>;\n  keys?: SelectKeysType;\n}\n\nconst componentType = 'select';\n\nconst Option = (props: SelectOptionProps) => {\n  const {\n    disabled: propDisabled,\n    label: propLabel,\n    selectedValue,\n    multiple,\n    size,\n    max,\n    keys,\n    value,\n    onSelect,\n    children,\n    restData,\n  } = props;\n\n  let selected: boolean;\n  const label = propLabel || value;\n  const disabled = propDisabled || (multiple && Array.isArray(selectedValue) && max && selectedValue.length >= max);\n\n  const { classPrefix } = useConfig();\n  const optionRef = useRef();\n  // 使用斜八角动画\n  useRipple(optionRef);\n\n  // 处理单选场景\n  if (!multiple) {\n    selected =\n      isNumber(selectedValue) || isString(selectedValue)\n        ? value === selectedValue\n        : value === get(selectedValue, keys?.value || 'value');\n  }\n\n  // 处理多选场景\n  if (multiple && Array.isArray(selectedValue)) {\n    selected = selectedValue.some((item) => {\n      if (isNumber(item) || isString(item)) {\n        // 如果非object类型\n        return item === value;\n      }\n      return get(item, keys?.value || 'value') === value;\n    });\n  }\n\n  const handleSelect = (event: React.MouseEvent) => {\n    if (!disabled) {\n      onSelect(value, { label: String(label), selected, event, restData });\n    }\n  };\n\n  const renderItem = (children: React.ReactNode) => {\n    if (multiple) {\n      return (\n        <label\n          className={classNames(`${classPrefix}-checkbox`, {\n            [`${classPrefix}-is-disabled`]: disabled,\n            [`${classPrefix}-is-checked`]: selected,\n          })}\n        >\n          <input\n            type=\"checkbox\"\n            className={classNames(`${classPrefix}-checkbox__former`)}\n            value=\"\"\n            disabled={disabled && !selected}\n            onClick={(e) => e.stopPropagation()}\n          />\n          <span className={classNames(`${classPrefix}-checkbox__input`)}></span>\n          <span className={classNames(`${classPrefix}-checkbox__label`)}>{children || label}</span>\n        </label>\n      );\n    }\n    return <span>{children || label}</span>;\n  };\n\n  return (\n    <li\n      className={classNames(props.className, `${classPrefix}-${componentType}-option`, {\n        [`${classPrefix}-is-disabled`]: disabled,\n        [`${classPrefix}-is-selected`]: selected,\n        [`${classPrefix}-size-s`]: size === 'small',\n        [`${classPrefix}-size-l`]: size === 'large',\n      })}\n      key={value}\n      onClick={handleSelect}\n      ref={optionRef}\n    >\n      {renderItem(children)}\n    </li>\n  );\n};\n\nexport default Option;\n"],"names":["componentType","Option","props","propDisabled","disabled","propLabel","label","selectedValue","multiple","size","max","keys","value","onSelect","children","restData","selected","Array","isArray","length","useConfig","classPrefix","optionRef","useRef","useRipple","isNumber","isString","get","some","item","handleSelect","event","String","renderItem","children2","React","createElement","className","classNames","_defineProperty","type","onClick","e","stopPropagation","key","ref"],"mappings":"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"}