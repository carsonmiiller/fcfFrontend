{"version":3,"file":"useDrag.js","sources":["../../src/_util/useDrag.ts"],"sourcesContent":["import { useRef, useEffect } from 'react';\n\nexport interface Coordinate {\n  x: number;\n  y: number;\n}\n\ninterface DraggableCallback {\n  (coordinate: Coordinate, event?: MouseEvent): void;\n}\n\ninterface DraggableProps {\n  start?: DraggableCallback;\n  drag?: DraggableCallback;\n  end?: DraggableCallback;\n}\n\nconst useDrag = (ref, options: DraggableProps) => {\n  const { start, end, drag } = options;\n\n  const isDraggingRef = useRef(false);\n\n  const getCoordinate = (event: MouseEvent) => {\n    try {\n      const rect = ref.current?.getBoundingClientRect();\n      const left = event.clientX - rect.left;\n      const top = event.clientY - rect.top;\n      return {\n        y: Math.min(Math.max(0, top), rect.height),\n        x: Math.min(Math.max(0, left), rect.width),\n      };\n    } catch (error) {\n      return {\n        y: null,\n        x: null,\n      };\n    }\n  };\n\n  const handlePointerMove = (e: MouseEvent) => {\n    if (isDraggingRef.current) drag(getCoordinate(e), e);\n  };\n\n  const handlePointerUp = (e: MouseEvent) => {\n    isDraggingRef.current = false;\n    end(getCoordinate(e), e);\n    window.removeEventListener('mouseup', handlePointerUp);\n    window.removeEventListener('mousemove', handlePointerMove);\n  };\n\n  const handlePointerDown = (e: MouseEvent) => {\n    isDraggingRef.current = true;\n    start(getCoordinate(e), e);\n    window.addEventListener('mouseup', handlePointerUp);\n    window.addEventListener('mousemove', handlePointerMove);\n  };\n\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      element.addEventListener('mousedown', handlePointerDown);\n    }\n    return () => {\n      if (element) {\n        element.removeEventListener('mousedown', handlePointerDown);\n      }\n      window.removeEventListener('mouseup', handlePointerUp);\n      window.removeEventListener('mousemove', handlePointerMove);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return {\n    isDragging: isDraggingRef.current,\n  };\n};\n\nexport default useDrag;\n"],"names":["useDrag","ref","options","start","end","drag","isDraggingRef","useRef","getCoordinate","event","rect","current","getBoundingClientRect","left","clientX","top","clientY","y","Math","min","max","height","x","width","error","handlePointerMove","e","handlePointerUp","window","removeEventListener","handlePointerDown","addEventListener","useEffect","element","isDragging"],"mappings":"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"}