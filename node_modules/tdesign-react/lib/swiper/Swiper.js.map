{"version":3,"file":"Swiper.js","sources":["../../src/swiper/Swiper.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo, useRef, isValidElement } from 'react';\nimport classnames from 'classnames';\nimport { ChevronLeftIcon, ChevronRightIcon } from 'tdesign-icons-react';\nimport useConfig from '../_util/useConfig';\nimport noop from '../_util/noop';\nimport { TdSwiperProps, SwiperChangeSource, SwiperNavigation } from './type';\nimport { StyledProps } from '../common';\nimport { swiperDefaultProps } from './defaultProps';\n\nimport SwiperItem from './SwiperItem';\n\nexport interface SwiperProps extends TdSwiperProps, StyledProps {\n  children?: React.ReactNode;\n}\n\nenum CreateArrow {\n  Default = 'default',\n  Fraction = 'fraction',\n}\n\nenum ArrowClickDirection {\n  Left = 'left',\n  Right = 'right',\n}\n\nenum MouseAction {\n  Enter = 'enter',\n  Leave = 'leave',\n  Click = 'click',\n}\n\nconst defaultNavigation: SwiperNavigation = {\n  placement: 'inside',\n  showSlideBtn: 'always',\n  size: 'medium',\n  type: 'bars',\n};\n\nconst Swiper = (props: SwiperProps) => {\n  const {\n    animation, // 轮播切换动画效果类型\n    autoplay, // 是否自动播放\n    current, // 当前轮播在哪一项（下标）\n    defaultCurrent, // 当前轮播在哪一项（下标），非受控属性\n    direction, // 轮播滑动方向，包括横向滑动和纵向滑动两个方向\n    duration, // 滑动动画时长\n    interval, // 轮播间隔时间\n    trigger,\n    height,\n    loop,\n    stopOnHover,\n    onChange = noop, // 轮播切换时触发\n    className,\n    children,\n    navigation,\n    type,\n  } = props;\n  const { classPrefix } = useConfig();\n\n  let navigationConfig = defaultNavigation;\n  let navigationNode = null;\n  if (isValidElement(navigation)) {\n    navigationNode = navigation;\n  } else {\n    navigationConfig = { ...defaultNavigation, ...(navigation as SwiperNavigation) };\n  }\n\n  const [currentIndex, setCurrentIndex] = useState(defaultCurrent);\n  const [needAnimation, setNeedAnimation] = useState(false);\n  const [arrowShow, setArrowShow] = useState(navigationConfig.showSlideBtn === 'always');\n  const swiperTimer = useRef(null); // 计时器指针\n  const swiperAnimationTimer = useRef(null); // 计时器指针\n  const isHovering = useRef(false);\n  const swiperWrap = useRef(null);\n\n  const getWrapAttribute = (attr) => swiperWrap.current?.parentNode?.[attr];\n\n  // 进行子组件筛选，创建子节点列表\n  const childrenList = useMemo(\n    () =>\n      React.Children.toArray(children).filter(\n        (child: JSX.Element) => child.type.displayName === SwiperItem.displayName,\n      ),\n    [children],\n  );\n  const childrenLength = childrenList.length;\n\n  // 创建渲染用的节点列表\n  const swiperItemList = childrenList.map((child: JSX.Element, index: number) =>\n    React.cloneElement(child, {\n      key: index,\n      index,\n      currentIndex,\n      needAnimation,\n      childrenLength,\n      getWrapAttribute,\n      ...props,\n      ...child.props,\n    }),\n  );\n  // 子节点不为空时，复制第一个子节点到列表最后\n  if (childrenLength > 0 && type === 'default') {\n    const firstEle = swiperItemList[0];\n    swiperItemList.push(\n      React.cloneElement(firstEle, { ...firstEle.props, key: childrenLength, index: childrenLength }),\n    );\n  }\n  const swiperItemLength = swiperItemList.length;\n\n  // 统一跳转处理函数\n  const swiperTo = useCallback(\n    (index: number, context: { source: SwiperChangeSource }) => {\n      // 事件通知\n      onChange(index % childrenLength, context);\n      // 设置内部 index\n      setNeedAnimation(true);\n      setCurrentIndex(index);\n    },\n    [childrenLength, onChange],\n  );\n\n  // 定时器\n  const setTimer = useCallback(() => {\n    if (autoplay && interval > 0) {\n      swiperTimer.current = setTimeout(\n        () => {\n          swiperTo(currentIndex + 1, { source: 'autoplay' });\n        },\n        currentIndex === 0 ? interval - (duration + 50) : interval, // 当 index 为 0 的时候，表明刚从克隆的最后一项跳转过来，已经经历了duration + 50 的间隔时间，减去即可\n      );\n    }\n  }, [autoplay, currentIndex, duration, interval, swiperTo]);\n\n  const clearTimer = useCallback(() => {\n    if (swiperTimer.current) {\n      clearTimeout(swiperTimer.current);\n      swiperTimer.current = null;\n    }\n  }, []);\n\n  const isEnd = useCallback(() => {\n    if (type === 'card') {\n      return !loop && currentIndex + 1 >= swiperItemLength;\n    }\n    return !loop && currentIndex + 2 >= swiperItemLength;\n  }, [loop, currentIndex, swiperItemLength, type]);\n\n  // 监听 current 参数变化\n  useEffect(() => {\n    if (current !== undefined) {\n      swiperTo(current % childrenLength, { source: 'autoplay' });\n    }\n  }, [current, childrenLength, swiperTo]);\n\n  // 监听每次轮播结束\n  useEffect(() => {\n    if (currentIndex + 1 > swiperItemLength && type === 'card') {\n      return setCurrentIndex(0);\n    }\n    if (swiperAnimationTimer.current) {\n      clearTimeout(swiperAnimationTimer.current);\n      swiperAnimationTimer.current = null;\n    }\n    swiperAnimationTimer.current = setTimeout(() => {\n      setNeedAnimation(false);\n      if (isEnd()) {\n        clearTimer();\n      }\n      if (currentIndex + 1 >= swiperItemLength && type !== 'card') {\n        setCurrentIndex(0);\n      }\n    }, duration + 50); // 多 50ms 的间隔时间参考了 react-slick 的动画间隔取值\n  }, [currentIndex, swiperItemLength, duration, type, clearTimer, isEnd]);\n\n  useEffect(() => {\n    if (!isHovering.current || !stopOnHover) {\n      clearTimer();\n      setTimer();\n    }\n  }, [setTimer, clearTimer, stopOnHover]);\n\n  // 鼠标移入移出事件\n  const onMouseEnter = () => {\n    isHovering.current = true;\n    if (stopOnHover) {\n      clearTimer();\n    }\n    if (navigationConfig.showSlideBtn === 'hover') {\n      setArrowShow(true);\n    }\n  };\n  const onMouseLeave = () => {\n    isHovering.current = false;\n    if (!isEnd()) {\n      setTimer();\n    }\n    if (navigationConfig.showSlideBtn === 'hover') {\n      setArrowShow(false);\n    }\n  };\n\n  const navMouseAction = (action: MouseAction, index: number) => {\n    if (action === MouseAction.Enter && trigger === 'hover') {\n      swiperTo(index, { source: 'hover' });\n    }\n    if (action === MouseAction.Click && trigger === 'click') {\n      swiperTo(index, { source: 'click' });\n    }\n  };\n\n  const arrowClick = (direction: ArrowClickDirection) => {\n    if (needAnimation) {\n      return false;\n    }\n    if (direction === ArrowClickDirection.Right) {\n      if (type === 'card') {\n        return swiperTo(currentIndex + 1 >= swiperItemLength ? 0 : currentIndex + 1, { source: 'click' });\n      }\n      return swiperTo(currentIndex + 1, { source: 'click' });\n    }\n    if (direction === ArrowClickDirection.Left) {\n      if (currentIndex - 1 < 0) {\n        return swiperTo(childrenLength - 1, { source: 'click' });\n      }\n      return swiperTo(currentIndex - 1, { source: 'click' });\n    }\n  };\n\n  const createArrow = (type: CreateArrow) => {\n    if (!arrowShow) {\n      return '';\n    }\n    if (navigationConfig.type === 'fraction' && type === CreateArrow.Default) {\n      return '';\n    }\n    const fractionIndex = currentIndex + 1 > childrenLength ? 1 : currentIndex + 1;\n    return (\n      <div\n        className={classnames(`${classPrefix}-swiper__arrow`, {\n          [`${classPrefix}-swiper__arrow--default`]: type === 'default',\n        })}\n      >\n        <div className={`${classPrefix}-swiper__arrow-left`} onClick={() => arrowClick(ArrowClickDirection.Left)}>\n          <ChevronLeftIcon />\n        </div>\n        {type === CreateArrow.Fraction ? (\n          <div className={`${classPrefix}-swiper__navigation-text-fraction`}>\n            {fractionIndex}/{childrenLength}\n          </div>\n        ) : (\n          ''\n        )}\n        <div className={`${classPrefix}-swiper__arrow-right`} onClick={() => arrowClick(ArrowClickDirection.Right)}>\n          <ChevronRightIcon />\n        </div>\n      </div>\n    );\n  };\n\n  const createNavigation = () => {\n    if (navigationConfig.type === 'fraction') {\n      return (\n        <div className={classnames(`${classPrefix}-swiper__navigation`, `${classPrefix}-swiper__navigation--fraction`)}>\n          {createArrow(CreateArrow.Fraction)}\n        </div>\n      );\n    }\n    return navigationNode ? (\n      <>{navigationNode}</>\n    ) : (\n      <ul\n        className={classnames(`${classPrefix}-swiper__navigation`, {\n          [`${classPrefix}-swiper__navigation-bars`]: navigationConfig.type === 'bars',\n        })}\n      >\n        {childrenList.map((_: JSX.Element, i: number) => (\n          <li\n            key={i}\n            className={classnames(`${classPrefix}-swiper__navigation-item`, {\n              [`${classPrefix}-is-active`]: i === currentIndex % childrenLength,\n            })}\n            onClick={() => navMouseAction(MouseAction.Click, i)}\n            onMouseEnter={() => navMouseAction(MouseAction.Enter, i)}\n            onMouseLeave={() => navMouseAction(MouseAction.Leave, i)}\n          >\n            <span></span>\n          </li>\n        ))}\n      </ul>\n    );\n  };\n\n  // 构造 css 对象\n  const getWrapperStyle = () => {\n    const offsetHeight = height ? `${height}px` : `${getWrapAttribute('offsetHeight')}px`;\n    if (type === 'card' || animation === 'fade') {\n      return {\n        height: offsetHeight,\n      };\n    }\n    if (animation === 'slide') {\n      if (direction === 'vertical') {\n        return {\n          height: offsetHeight,\n          msTransform: `translate3d(0, -${currentIndex * 100}%, 0px)`,\n          WebkitTransform: `translate3d(0, -${currentIndex * 100}%, 0px)`,\n          transform: `translate3d(0, -${currentIndex * 100}%, 0px)`,\n          transition: needAnimation ? `transform ${duration / 1000}s ease` : '',\n        };\n      }\n      return {\n        msTransform: `translate3d(-${currentIndex * 100}%, 0px, 0px)`,\n        WebkitTransform: `translate3d(-${currentIndex * 100}%, 0px, 0px)`,\n        transform: `translate3d(-${currentIndex * 100}%, 0px, 0px)`,\n        transition: needAnimation ? `transform ${duration / 1000}s ease` : '',\n      };\n    }\n  };\n\n  return (\n    <div\n      className={classnames(`${classPrefix}-swiper`, className)}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      ref={swiperWrap}\n    >\n      <div\n        className={classnames(`${classPrefix}-swiper__wrap`, {\n          [`${classPrefix}-swiper--inside`]: navigationConfig.placement === 'inside',\n          [`${classPrefix}-swiper--outside`]: navigationConfig.placement === 'outside',\n          [`${classPrefix}-swiper--vertical`]: direction === 'vertical',\n          [`${classPrefix}-swiper--large`]: navigationConfig.size === 'large',\n          [`${classPrefix}-swiper--small`]: navigationConfig.size === 'small',\n        })}\n      >\n        <div\n          className={classnames(`${classPrefix}-swiper__content`, {\n            [`${classPrefix}-swiper-fade`]: animation === 'fade',\n            [`${classPrefix}-swiper-card`]: type === 'card',\n          })}\n          style={{ height: '' }}\n        >\n          <div className={`${classPrefix}-swiper__container`} style={getWrapperStyle()}>\n            {swiperItemList}\n          </div>\n        </div>\n        {createNavigation()}\n        {createArrow(CreateArrow.Default)}\n      </div>\n    </div>\n  );\n};\n\nSwiper.SwiperItem = SwiperItem;\n\nSwiper.displayName = 'Swiper';\nSwiper.defaultProps = swiperDefaultProps;\n\nexport default Swiper;\n"],"names":["defaultNavigation","placement","showSlideBtn","size","type","Swiper","props","animation","autoplay","current","defaultCurrent","direction","duration","interval","trigger","height","loop","stopOnHover","onChange","noop","className","children","navigation","useConfig","classPrefix","navigationConfig","navigationNode","isValidElement","useState","_slicedToArray","currentIndex","setCurrentIndex","needAnimation","setNeedAnimation","arrowShow","setArrowShow","swiperTimer","useRef","swiperAnimationTimer","isHovering","swiperWrap","getWrapAttribute","attr","parentNode","childrenList","useMemo","React","Children","toArray","filter","child","displayName","SwiperItem","childrenLength","length","swiperItemList","map","index","cloneElement","key","firstEle","push","swiperItemLength","swiperTo","useCallback","context","setTimer","setTimeout","source","clearTimer","clearTimeout","isEnd","useEffect","onMouseEnter","onMouseLeave","navMouseAction","action","arrowClick","direction2","createArrow","type2","fractionIndex","createElement","classnames","onClick","ChevronLeftIcon","ChevronRightIcon","createNavigation","Fragment","_defineProperty","_","i","getWrapperStyle","offsetHeight","msTransform","WebkitTransform","transform","transition","ref","style","defaultProps","swiperDefaultProps"],"mappings":"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"}