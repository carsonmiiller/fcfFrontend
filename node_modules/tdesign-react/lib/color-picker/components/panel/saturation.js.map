{"version":3,"file":"saturation.js","sources":["../../../../src/color-picker/components/panel/saturation.tsx"],"sourcesContent":["import React, { useRef, useEffect, useCallback } from 'react';\nimport { SATURATION_PANEL_DEFAULT_HEIGHT, SATURATION_PANEL_DEFAULT_WIDTH } from '../../const';\nimport { TdColorBaseProps } from '../../interface';\nimport useDrag, { Coordinate } from '../../../_util/useDrag';\n\nconst Saturation = (props: TdColorBaseProps) => {\n  const { color, disabled, onChange, baseClassName } = props;\n  const panelRef = useRef<HTMLDivElement>(null);\n  const thumbRef = useRef<HTMLElement>(null);\n  const panelRectRef = useRef({\n    width: SATURATION_PANEL_DEFAULT_WIDTH,\n    height: SATURATION_PANEL_DEFAULT_HEIGHT,\n  });\n\n  const styles = () => {\n    const { saturation, value, rgb } = color;\n    const { width, height } = panelRectRef.current;\n    const top = Math.round((1 - value) * height);\n    const left = Math.round(saturation * width);\n    return {\n      color: rgb,\n      left: `${left}px`,\n      top: `${top}px`,\n    };\n  };\n\n  const getSaturationAndValueByCoordinate = (coordinate: Coordinate) => {\n    const { width, height } = panelRectRef.current;\n    const { x, y } = coordinate;\n    const saturation = Math.round((x / width) * 100);\n    const value = Math.round((1 - y / height) * 100);\n    return {\n      saturation,\n      value,\n    };\n  };\n\n  const isDragging = useRef<Boolean>(false);\n\n  const handleDrag = useCallback(\n    ({ x, y }: Coordinate, isEnd?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      isDragging.current = true;\n      const { saturation, value } = getSaturationAndValueByCoordinate({ x, y });\n      onChange({\n        saturation: saturation / 100,\n        value: value / 100,\n        addUsedColor: isEnd,\n      });\n    },\n    [disabled, onChange],\n  );\n\n  const handleDragEnd = useCallback((coordinate: Coordinate) => {\n    if (disabled) {\n      return;\n    }\n    isDragging.current = false;\n    handleDrag(coordinate, true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useDrag(panelRef, {\n    start: () => {\n      panelRectRef.current.width = panelRef.current.offsetWidth;\n      panelRectRef.current.height = panelRef.current.offsetHeight;\n    },\n    end: (coordinate: Coordinate) => {\n      handleDragEnd(coordinate);\n    },\n    drag: (coordinate: Coordinate) => {\n      handleDrag(coordinate);\n    },\n  });\n\n  useEffect(() => {\n    panelRectRef.current.width = panelRef.current.offsetWidth || SATURATION_PANEL_DEFAULT_WIDTH;\n    panelRectRef.current.height = panelRef.current.offsetHeight || SATURATION_PANEL_DEFAULT_HEIGHT;\n  }, [handleDrag, handleDragEnd]);\n\n  return (\n    <div\n      className={`${baseClassName}__saturation`}\n      ref={panelRef}\n      style={{\n        background: `hsl(${color.hue}, 100%, 50%)`,\n      }}\n    >\n      <span\n        className={`${baseClassName}__thumb`}\n        role=\"slider\"\n        tabIndex={0}\n        ref={thumbRef}\n        style={{ ...styles() }}\n      ></span>\n    </div>\n  );\n};\n\nexport default React.memo(Saturation);\n"],"names":["Saturation","props","color","disabled","onChange","baseClassName","panelRef","useRef","thumbRef","panelRectRef","width","SATURATION_PANEL_DEFAULT_WIDTH","height","SATURATION_PANEL_DEFAULT_HEIGHT","styles","saturation","value","rgb","current","top","Math","round","left","getSaturationAndValueByCoordinate","coordinate","x","y","isDragging","handleDrag","useCallback","isEnd","addUsedColor","handleDragEnd","useDrag","start","offsetWidth","offsetHeight","end","drag","useEffect","React","createElement","className","ref","style","background","hue","role","tabIndex","memo"],"mappings":"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"}