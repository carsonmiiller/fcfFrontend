{"version":3,"file":"inputs.js","sources":["../../../../../src/color-picker/components/panel/format/inputs.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport { throttle } from 'lodash';\nimport Color from '../../../../_common/js/color-picker/color';\nimport Input from '../../../../input';\nimport InputNumber from '../../../../input-number';\nimport { FORMAT_INPUT_CONFIG } from './config';\n\nconst FormatInputs = (props) => {\n  const { format, enableAlpha, inputProps, disabled, onInputChange, color } = props;\n  const formatValue = useRef<any>({});\n  const lastModelValue = useRef({});\n\n  const object2color = (f: string) => Color.object2color(formatValue.current, f);\n\n  // 获取不同格式的输入输出值\n  const getFormatColorMap = (type: 'encode' | 'decode') => {\n    if (type === 'encode') {\n      return {\n        HSV: color.getHsva(),\n        HSL: color.getHsla(),\n        RGB: color.getRgba(),\n        CMYK: color.getCmyk(),\n        CSS: {\n          css: color.css,\n        },\n        HEX: {\n          hex: color.hex,\n        },\n      };\n    }\n    // decode\n    return {\n      HSV: object2color('HSV'),\n      HSL: object2color('HSL'),\n      RGB: object2color('RGB'),\n      CMYK: object2color('CMYK'),\n      CSS: formatValue.current.css,\n      HEX: formatValue.current.hex,\n    };\n  };\n\n  // 更新modelValue\n  const updateModelValue = () => {\n    const values: any = getFormatColorMap('encode')[format];\n    values.a = Math.round(color.alpha * 100);\n    Object.keys(values).forEach((key) => {\n      formatValue.current[key] = values[key];\n      lastModelValue.current[key] = values[key];\n    });\n  };\n\n  updateModelValue();\n\n  const throttleUpdate = throttle(updateModelValue, 100);\n\n  const inputConfigs = () => {\n    const configs = [...FORMAT_INPUT_CONFIG[format]];\n    if (enableAlpha) {\n      configs.push({\n        type: 'inputNumber',\n        key: 'a',\n        min: 0,\n        max: 100,\n        format: (value: number) => `${value}%`,\n        flex: 1.15,\n      });\n    }\n    return configs;\n  };\n\n  const handleInputChange = (key: string, v: number | string) => {\n    if (v === lastModelValue[key]) {\n      return;\n    }\n    formatValue.current[key] = v;\n    lastModelValue.current[key] = v;\n    const value = getFormatColorMap('decode')[format];\n    onInputChange(value, formatValue.current.a / 100, key, v);\n  };\n\n  useEffect(() => {\n    throttleUpdate();\n  }, [color.saturation, color.hue, color.value, color.alpha, format, throttleUpdate]);\n\n  return (\n    <div className=\"input-group\">\n      {inputConfigs().map((config) => {\n        const commonProps = {\n          ...inputProps,\n          title: formatValue.current[config.key],\n          value: formatValue.current[config.key],\n          align: 'center',\n          disabled,\n          onBlur: (v: string) => handleInputChange(config.key, v),\n          onEnter: (v: string) => handleInputChange(config.key, v),\n        };\n        return (\n          <div\n            className=\"input-group__item\"\n            key={config.key}\n            style={{\n              flex: config.flex || 1,\n            }}\n          >\n            {config.type === 'input' ? (\n              <Input {...commonProps} maxlength={format === 'HEX' ? 9 : undefined} />\n            ) : (\n              <InputNumber\n                {...commonProps}\n                min={config.min}\n                max={config.max}\n                step={1}\n                format={config.format}\n                theme=\"normal\"\n              />\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n\nexport default React.memo(FormatInputs);\n"],"names":["FormatInputs","props","format","enableAlpha","inputProps","disabled","onInputChange","color","formatValue","useRef","lastModelValue","object2color","f","Color","current","getFormatColorMap","type","HSV","getHsva","HSL","getHsla","RGB","getRgba","CMYK","getCmyk","CSS","css","HEX","hex","updateModelValue","values","a","Math","round","alpha","Object","keys","forEach","key","throttleUpdate","throttle","inputConfigs","configs","FORMAT_INPUT_CONFIG","push","min","max","value","flex","handleInputChange","v","useEffect","saturation","hue","React","createElement","className","map","config","commonProps","title","align","onBlur","onEnter","style","Input","maxlength","InputNumber","step","theme","memo"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC9B,EAAA,IAAQC,MAAR,GAA4ED,KAA5E,CAAQC,MAAR;AAAA,MAAgBC,WAAhB,GAA4EF,KAA5E,CAAgBE,WAAhB;AAAA,MAA6BC,UAA7B,GAA4EH,KAA5E,CAA6BG,UAA7B;AAAA,MAAyCC,QAAzC,GAA4EJ,KAA5E,CAAyCI,QAAzC;AAAA,MAAmDC,aAAnD,GAA4EL,KAA5E,CAAmDK,aAAnD;AAAA,MAAkEC,KAAlE,GAA4EN,KAA5E,CAAkEM,KAAlE,CAAA;AACA,EAAA,IAAMC,WAAW,GAAGC,YAAM,CAAC,EAAD,CAA1B,CAAA;AACA,EAAA,IAAMC,cAAc,GAAGD,YAAM,CAAC,EAAD,CAA7B,CAAA;;AACA,EAAA,IAAME,YAAY,GAAG,SAAfA,YAAe,CAACC,CAAD,EAAA;IAAA,OAAOC,kCAAK,CAACF,YAAN,CAAmBH,WAAW,CAACM,OAA/B,EAAwCF,CAAxC,CAAP,CAAA;GAArB,CAAA;;AACA,EAAA,IAAMG,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,IAAD,EAAU;IAClC,IAAIA,IAAI,KAAK,QAAb,EAAuB;MACrB,OAAO;AACLC,QAAAA,GAAG,EAAEV,KAAK,CAACW,OAAN,EADA;AAELC,QAAAA,GAAG,EAAEZ,KAAK,CAACa,OAAN,EAFA;AAGLC,QAAAA,GAAG,EAAEd,KAAK,CAACe,OAAN,EAHA;AAILC,QAAAA,IAAI,EAAEhB,KAAK,CAACiB,OAAN,EAJD;AAKLC,QAAAA,GAAG,EAAE;UACHC,GAAG,EAAEnB,KAAK,CAACmB,GAAAA;SANR;AAQLC,QAAAA,GAAG,EAAE;UACHC,GAAG,EAAErB,KAAK,CAACqB,GAAAA;AADR,SAAA;OARP,CAAA;AAYD,KAAA;;IACD,OAAO;AACLX,MAAAA,GAAG,EAAEN,YAAY,CAAC,KAAD,CADZ;AAELQ,MAAAA,GAAG,EAAER,YAAY,CAAC,KAAD,CAFZ;AAGLU,MAAAA,GAAG,EAAEV,YAAY,CAAC,KAAD,CAHZ;AAILY,MAAAA,IAAI,EAAEZ,YAAY,CAAC,MAAD,CAJb;AAKLc,MAAAA,GAAG,EAAEjB,WAAW,CAACM,OAAZ,CAAoBY,GALpB;AAMLC,MAAAA,GAAG,EAAEnB,WAAW,CAACM,OAAZ,CAAoBc,GAAAA;KAN3B,CAAA;GAfF,CAAA;;AAwBA,EAAA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;IAC7B,IAAMC,MAAM,GAAGf,iBAAiB,CAAC,QAAD,CAAjB,CAA4Bb,MAA5B,CAAf,CAAA;AACA4B,IAAAA,MAAM,CAACC,CAAP,GAAWC,IAAI,CAACC,KAAL,CAAW1B,KAAK,CAAC2B,KAAN,GAAc,GAAzB,CAAX,CAAA;IACAC,MAAM,CAACC,IAAP,CAAYN,MAAZ,EAAoBO,OAApB,CAA4B,UAACC,GAAD,EAAS;MACnC9B,WAAW,CAACM,OAAZ,CAAoBwB,GAApB,IAA2BR,MAAM,CAACQ,GAAD,CAAjC,CAAA;MACA5B,cAAc,CAACI,OAAf,CAAuBwB,GAAvB,IAA8BR,MAAM,CAACQ,GAAD,CAApC,CAAA;KAFF,CAAA,CAAA;GAHF,CAAA;;EAQAT,gBAAgB,EAAA,CAAA;AAChB,EAAA,IAAMU,cAAc,GAAGC,eAAQ,CAACX,gBAAD,EAAmB,GAAnB,CAA/B,CAAA;;AACA,EAAA,IAAMY,YAAY,GAAG,SAAfA,YAAe,GAAM;AACzB,IAAA,IAAMC,OAAO,GAAOC,oCAAAA,CAAAA,8DAAmB,CAACzC,MAAD,CAA1B,CAAb,CAAA;;AACA,IAAA,IAAIC,WAAJ,EAAiB;MACfuC,OAAO,CAACE,IAAR,CAAa;AACX5B,QAAAA,IAAI,EAAE,aADK;AAEXsB,QAAAA,GAAG,EAAE,GAFM;AAGXO,QAAAA,GAAG,EAAE,CAHM;AAIXC,QAAAA,GAAG,EAAE,GAJM;QAKX5C,MAAM,EAAE,gBAAC6C,KAAD,EAAA;AAAA,UAAA,OAAA,EAAA,CAAA,MAAA,CAAcA,KAAd,EAAA,GAAA,CAAA,CAAA;SALG;AAMXC,QAAAA,IAAI,EAAE,IAAA;OANR,CAAA,CAAA;AAQD,KAAA;;AACD,IAAA,OAAON,OAAP,CAAA;GAZF,CAAA;;EAcA,IAAMO,iBAAiB,GAAG,SAApBA,iBAAoB,CAACX,GAAD,EAAMY,CAAN,EAAY;AACpC,IAAA,IAAIA,CAAC,KAAKxC,cAAc,CAAC4B,GAAD,CAAxB,EAA+B;AAC7B,MAAA,OAAA;AACD,KAAA;;AACD9B,IAAAA,WAAW,CAACM,OAAZ,CAAoBwB,GAApB,IAA2BY,CAA3B,CAAA;AACAxC,IAAAA,cAAc,CAACI,OAAf,CAAuBwB,GAAvB,IAA8BY,CAA9B,CAAA;IACA,IAAMH,KAAK,GAAGhC,iBAAiB,CAAC,QAAD,CAAjB,CAA4Bb,MAA5B,CAAd,CAAA;AACAI,IAAAA,aAAa,CAACyC,KAAD,EAAQvC,WAAW,CAACM,OAAZ,CAAoBiB,CAApB,GAAwB,GAAhC,EAAqCO,GAArC,EAA0CY,CAA1C,CAAb,CAAA;GAPF,CAAA;;AASAC,EAAAA,eAAS,CAAC,YAAM;IACdZ,cAAc,EAAA,CAAA;GADP,EAEN,CAAChC,KAAK,CAAC6C,UAAP,EAAmB7C,KAAK,CAAC8C,GAAzB,EAA8B9C,KAAK,CAACwC,KAApC,EAA2CxC,KAAK,CAAC2B,KAAjD,EAAwDhC,MAAxD,EAAgEqC,cAAhE,CAFM,CAAT,CAAA;AAGA,EAAA,sBAAuBe,yBAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AAChDC,IAAAA,SAAS,EAAE,aAAA;AADqC,GAA3B,EAEpBf,YAAY,EAAA,CAAGgB,GAAf,CAAmB,UAACC,MAAD,EAAY;IAChC,IAAMC,WAAW,mCACZvD,UADY,CAAA,EAAA,EAAA,EAAA;MAEfwD,KAAK,EAAEpD,WAAW,CAACM,OAAZ,CAAoB4C,MAAM,CAACpB,GAA3B,CAFQ;MAGfS,KAAK,EAAEvC,WAAW,CAACM,OAAZ,CAAoB4C,MAAM,CAACpB,GAA3B,CAHQ;AAIfuB,MAAAA,KAAK,EAAE,QAJQ;AAKfxD,MAAAA,QAAQ,EAARA,QALe;MAMfyD,MAAM,EAAE,gBAACZ,CAAD,EAAA;AAAA,QAAA,OAAOD,iBAAiB,CAACS,MAAM,CAACpB,GAAR,EAAaY,CAAb,CAAxB,CAAA;OANO;MAOfa,OAAO,EAAE,iBAACb,CAAD,EAAA;AAAA,QAAA,OAAOD,iBAAiB,CAACS,MAAM,CAACpB,GAAR,EAAaY,CAAb,CAAxB,CAAA;AAAA,OAAA;KAPX,CAAA,CAAA;;AASA,IAAA,sBAAuBI,yBAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AAChDC,MAAAA,SAAS,EAAE,mBADqC;MAEhDlB,GAAG,EAAEoB,MAAM,CAACpB,GAFoC;AAGhD0B,MAAAA,KAAK,EAAE;AACLhB,QAAAA,IAAI,EAAEU,MAAM,CAACV,IAAP,IAAe,CAAA;AADhB,OAAA;AAHyC,KAA3B,EAMpBU,MAAM,CAAC1C,IAAP,KAAgB,OAAhB,kBAA0CsC,yBAAK,CAACC,aAAN,CAAoBU,iBAApB,kCACxCN,WADwC,CAAA,EAAA,EAAA,EAAA;AAE3CO,MAAAA,SAAS,EAAEhE,MAAM,KAAK,KAAX,GAAmB,CAAnB,GAAuB,KAAK,CAAA;KAFtC,CAAA,CAAA,kBAGkBoD,yBAAK,CAACC,aAAN,CAAoBY,6BAApB,kCAChBR,WADgB,CAAA,EAAA,EAAA,EAAA;MAEnBd,GAAG,EAAEa,MAAM,CAACb,GAFO;MAGnBC,GAAG,EAAEY,MAAM,CAACZ,GAHO;AAInBsB,MAAAA,IAAI,EAAE,CAJa;MAKnBlE,MAAM,EAAEwD,MAAM,CAACxD,MALI;AAMnBmE,MAAAA,KAAK,EAAE,QAAA;AANY,KAAA,CAAA,CATE,CAAvB,CAAA;AAiBD,GA3BE,CAFoB,CAAvB,CAAA;AA8BD,CA/FD,CAAA;;AAgGA,kBAAA,aAAef,yBAAK,CAACgB,IAAN,CAAWtE,YAAX,CAAf;;;;"}