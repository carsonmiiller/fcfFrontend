{"version":3,"file":"StepHandler.js","sources":["../../src/input-number/StepHandler.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport classNames from 'classnames';\n\nimport { ChevronUpIcon, ChevronDownIcon, RemoveIcon, AddIcon } from 'tdesign-icons-react';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport Button from '../button';\n\nimport { InputNumberProps, ChangeContext } from './InputNumber';\n\nexport interface StepHandlerProps {\n  prefixClassName: string;\n  theme: InputNumberProps['theme'];\n  onStep: React.Dispatch<ChangeContext>;\n  disabledDecrease: boolean;\n  disabledIncrease: boolean;\n  children: React.ReactElement;\n}\n\nlet timer: NodeJS.Timer;\nconst triggerDelay = 500;\nconst stepDelay = 200;\nexport default function StepHandler(props: StepHandlerProps) {\n  const { prefixClassName, theme, onStep, disabledDecrease, disabledIncrease, children } = props;\n  const commonClassNames = useCommonClassName();\n\n  const isNormalTheme = theme === 'normal';\n  const decreaseIcon = theme === 'column' ? <ChevronDownIcon /> : <RemoveIcon />;\n  const increaseIcon = theme === 'column' ? <ChevronUpIcon /> : <AddIcon />;\n\n  const onStepSaver = useRef<any>();\n  onStepSaver.current = (params: ChangeContext) => {\n    const { type, e } = params;\n    if (type === 'reduce') {\n      disabledDecrease || onStep({ type, e });\n    }\n    disabledIncrease || onStep({ type, e });\n  };\n\n  const handleMouseDown = (e, type) => {\n    onStepSaver.current({ type, e });\n    setTimeout(() => {\n      timer = setInterval(() => {\n        onStepSaver.current({ type, e });\n      }, stepDelay);\n    }, triggerDelay);\n  };\n  const stopInterval = () => {\n    clearInterval(timer);\n    setTimeout(() => {\n      clearInterval(timer);\n    }, triggerDelay);\n  };\n\n  return (\n    <>\n      {!isNormalTheme && (\n        <Button\n          variant=\"outline\"\n          className={classNames(`${prefixClassName}__decrease`, {\n            [commonClassNames.STATUS.disabled]: disabledDecrease,\n          })}\n          onMouseDown={(e) => {\n            handleMouseDown(e, 'reduce');\n          }}\n          onMouseUp={stopInterval}\n          onMouseLeave={stopInterval}\n          icon={decreaseIcon}\n          shape=\"square\"\n        ></Button>\n      )}\n\n      {children}\n      {!isNormalTheme && (\n        <Button\n          variant=\"outline\"\n          className={classNames(`${prefixClassName}__increase`, {\n            [commonClassNames.STATUS.disabled]: disabledIncrease,\n          })}\n          onMouseDown={(e) => {\n            handleMouseDown(e, 'add');\n          }}\n          onMouseUp={stopInterval}\n          onMouseLeave={stopInterval}\n          icon={increaseIcon}\n          shape=\"square\"\n        ></Button>\n      )}\n    </>\n  );\n}\n"],"names":["timer","triggerDelay","stepDelay","StepHandler","props","prefixClassName","theme","onStep","disabledDecrease","disabledIncrease","children","commonClassNames","useCommonClassName","isNormalTheme","decreaseIcon","React","createElement","ChevronDownIcon","RemoveIcon","increaseIcon","ChevronUpIcon","AddIcon","onStepSaver","useRef","current","params","type","e","handleMouseDown","setTimeout","setInterval","stopInterval","clearInterval","Fragment","Button","variant","className","classNames","STATUS","disabled","onMouseDown","onMouseUp","onMouseLeave","icon","shape"],"mappings":"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"}