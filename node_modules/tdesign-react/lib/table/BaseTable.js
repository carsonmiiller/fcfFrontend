/**
 * tdesign v0.34.4
 * (c) 2022 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var defineProperty = require('../_chunks/dep-a1655de1.js');
var React = require('react');
var pick = require('../_chunks/dep-46e6aa42.js');
var classNames = require('classnames');
var loading_index = require('../loading/index.js');
var table_TBody = require('./TBody.js');
var affix_index = require('../affix/index.js');
var table_TR = require('./TR.js');
var table_THead = require('./THead.js');
var table_TFoot = require('./TFoot.js');
var table_hooks_useTableHeader = require('./hooks/useTableHeader.js');
var table_hooks_useFixed = require('./hooks/useFixed.js');
var table_hooks_usePagination = require('./hooks/usePagination.js');
var table_hooks_useStyle = require('./hooks/useStyle.js');
var table_hooks_useClassName = require('./hooks/useClassName.js');
require('../_chunks/dep-8a3a8f07.js');
require('../_chunks/dep-c90cc28f.js');
require('../_chunks/dep-3405bda4.js');
require('../_chunks/dep-cb0f33ac.js');
require('../_chunks/dep-fcf32c81.js');
require('../_chunks/dep-b1a67107.js');
require('../_chunks/dep-3b69722d.js');
require('../_chunks/dep-fde4d28a.js');
require('../_chunks/dep-e266830c.js');
require('../_chunks/dep-15a4424e.js');
require('../_chunks/dep-c40d75ac.js');
require('../_chunks/dep-86abec96.js');
require('../_chunks/dep-c7b74e6e.js');
require('../_chunks/dep-9cacaf01.js');
require('../_chunks/dep-542cc308.js');
require('../_chunks/dep-8e0a771d.js');
require('../_chunks/dep-9c339ffc.js');
require('../_chunks/dep-c3bd0e8c.js');
require('../_chunks/dep-38856994.js');
require('../_chunks/dep-ec5420f8.js');
require('../loading/Loading.js');
require('../_chunks/dep-3cf9becb.js');
require('../_chunks/dep-19841e1d.js');
require('../_util/dom.js');
require('raf');
require('../_chunks/dep-1d819290.js');
require('../_util/easing.js');
require('../_util/useConfig.js');
require('../_chunks/dep-38a46f48.js');
require('../_chunks/dep-8a149e9f.js');
require('../_chunks/dep-910dcfa3.js');
require('../_chunks/dep-633a5671.js');
require('../_chunks/dep-ab43c961.js');
require('../_chunks/dep-c72c7229.js');
require('../_chunks/dep-c6637e11.js');
require('../_common/js/global-config/locale/zh_CN.js');
require('../config-provider/zh_CN_config.js');
require('../common/Portal.js');
require('react-dom');
require('../loading/gradient.js');
require('../_common/js/loading/circle-adapter.js');
require('../_common/js/utils/set-style.js');
require('../_common/js/utils/helper.js');
require('../_chunks/dep-23535a52.js');
require('../loading/defaultProps.js');
require('../loading/plugin.js');
require('../_chunks/dep-e3db5727.js');
require('../_chunks/dep-f3090217.js');
require('../_chunks/dep-d4a0b3f0.js');
require('../_chunks/dep-6dfb2577.js');
require('../_chunks/dep-3181fd9f.js');
require('../locale/LocalReceiver.js');
require('../affix/Affix.js');
require('../affix/defaultProps.js');
require('./utils.js');
require('./Ellipsis.js');
require('../_chunks/dep-85b3eaa4.js');
require('../_chunks/dep-e19f22f6.js');
require('../popup/index.js');
require('../popup/Popup.js');
require('react-transition-group');
require('react-popper');
require('../hooks/useControlled.js');
require('../_util/noop.js');
require('../_util/useAnimation.js');
require('../_util/composeRefs.js');
require('../popup/hooks/useTriggerProps.js');
require('../_util/useClickOutside.js');
require('../popup/utils/getTransitionParams.js');
require('../_util/useMutationObserver.js');
require('../_util/useWindowSize.js');
require('../popup/defaultProps.js');
require('./hooks/useLazyLoad.js');
require('../_common/js/utils/observe.js');
require('./hooks/useMultiHeader.js');
require('../_common/js/log/log.js');
require('../_common/js/utils/getScrollbarWidth.js');
require('../_chunks/dep-f6a4bdd5.js');
require('../pagination/index.js');
require('../pagination/Pagination.js');
require('../_chunks/dep-6580f19c.js');
require('../_chunks/dep-ce5aa35f.js');
require('../_chunks/dep-dfcfc710.js');
require('../_chunks/dep-029baf10.js');
require('../select/index.js');
require('../select/base/Select.js');
require('../tag/index.js');
require('../tag/Tag.js');
require('tdesign-icons-react');
require('../_util/forwardRefWithStatics.js');
require('hoist-non-react-statics');
require('../tag/CheckTag.js');
require('../tag/defaultProps.js');
require('../select/util/helper.js');
require('../select/base/OptionGroup.js');
require('../select/defaultProps.js');
require('../select/base/Option.js');
require('../_chunks/dep-bc80a1a5.js');
require('../_util/useRipple.js');
require('../_util/setStyle.js');
require('../common/FakeArrow.js');
require('../select-input/index.js');
require('../select-input/SelectInput.js');
require('../select-input/useSingle.js');
require('../input/index.js');
require('../input/Input.js');
require('../_util/helper.js');
require('../input/InputGroup.js');
require('../input/defaultProps.js');
require('../select-input/useMultiple.js');
require('../tag-input/index.js');
require('../tag-input/TagInput.js');
require('../_util/useDragSorter.js');
require('../tag-input/useTagScroll.js');
require('../tag-input/useTagList.js');
require('lodash');
require('../tag-input/useHover.js');
require('../tag-input/defaultProps.js');
require('../select-input/useOverlayStyle.js');
require('../select-input/defaultProps.js');
require('../select/base/PopupContent.js');
require('../input-number/index.js');
require('../input-number/InputNumber.js');
require('../_util/useCommonClassName.js');
require('../_util/useUpdateEffect.js');
require('../_util/useLayoutEffect.js');
require('../input-number/StepHandler.js');
require('../button/index.js');
require('../button/Button.js');
require('../button/defaultProps.js');
require('../input-number/utils/numberUtils.js');
require('../input-number/defaultProps.js');
require('../pagination/hooks/useBoundaryJumper.js');
require('../pagination/hooks/usePrevNextJumper.js');
require('../pagination/hooks/usePageNumber.js');
require('../pagination/hooks/useTotal.js');
require('../pagination/validators.js');
require('../pagination/defaultProps.js');
require('../hooks/useCommonClassName.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var classNames__default = /*#__PURE__*/_interopDefaultLegacy(classNames);

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { defineProperty._defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
var BASE_TABLE_EVENTS = ["page-change", "cell-click", "scroll", "scrollX", "scrollY"];
var BASE_TABLE_ALL_EVENTS = table_TR.ROW_LISTENERS.map(function (t) {
  return "row-".concat(t);
}).concat(BASE_TABLE_EVENTS);
var BaseTable = /*#__PURE__*/React.forwardRef(function (props, ref) {
  var _tableClasses$concat, _tableContentRef$curr;

  var tableLayout = props.tableLayout,
      height = props.height,
      data = props.data,
      columns = props.columns,
      style = props.style;
  var tableRef = React.useRef();
  var tableElmRef = React.useRef();

  var _useClassName = table_hooks_useClassName["default"](),
      tableLayoutClasses = _useClassName.tableLayoutClasses,
      tableBaseClass = _useClassName.tableBaseClass,
      tableColFixedClasses = _useClassName.tableColFixedClasses;

  var _useStyle = table_hooks_useStyle["default"](props),
      tableClasses = _useStyle.tableClasses,
      tableContentStyles = _useStyle.tableContentStyles,
      tableElementStyles = _useStyle.tableElementStyles;

  var _useFixed = table_hooks_useFixed["default"](props),
      affixHeaderRef = _useFixed.affixHeaderRef,
      scrollbarWidth = _useFixed.scrollbarWidth,
      tableWidth = _useFixed.tableWidth,
      tableContentRef = _useFixed.tableContentRef,
      isFixedHeader = _useFixed.isFixedHeader,
      isWidthOverflow = _useFixed.isWidthOverflow,
      isFixedColumn = _useFixed.isFixedColumn,
      thWidthList = _useFixed.thWidthList,
      showColumnShadow = _useFixed.showColumnShadow,
      showAffixHeader = _useFixed.showAffixHeader,
      rowAndColFixedPosition = _useFixed.rowAndColFixedPosition,
      onTableContentScroll = _useFixed.onTableContentScroll,
      updateHeaderScroll = _useFixed.updateHeaderScroll;

  var _useTableHeader = table_hooks_useTableHeader["default"]({
    columns: props.columns
  }),
      isMultipleHeader = _useTableHeader.isMultipleHeader,
      spansAndLeafNodes = _useTableHeader.spansAndLeafNodes,
      thList = _useTableHeader.thList;

  var _usePagination = table_hooks_usePagination["default"](props),
      dataSource = _usePagination.dataSource,
      isPaginateData = _usePagination.isPaginateData,
      renderPagination = _usePagination.renderPagination;

  var dynamicBaseTableClasses = classNames__default["default"](tableClasses.concat((_tableClasses$concat = {}, defineProperty._defineProperty(_tableClasses$concat, tableBaseClass.headerFixed, isFixedHeader), defineProperty._defineProperty(_tableClasses$concat, tableBaseClass.columnFixed, isFixedColumn), defineProperty._defineProperty(_tableClasses$concat, tableBaseClass.widthOverflow, isWidthOverflow), defineProperty._defineProperty(_tableClasses$concat, tableBaseClass.multipleHeader, isMultipleHeader), defineProperty._defineProperty(_tableClasses$concat, tableColFixedClasses.leftShadow, showColumnShadow.left), defineProperty._defineProperty(_tableClasses$concat, tableColFixedClasses.rightShadow, showColumnShadow.right), _tableClasses$concat)));
  var tableElmClasses = classNames__default["default"]([[tableLayoutClasses[tableLayout || "fixed"]], defineProperty._defineProperty({}, tableBaseClass.fullHeight, height)]);
  var showRightDivider = React.useMemo(function () {
    return props.bordered && isFixedHeader && (isMultipleHeader && isWidthOverflow || !isMultipleHeader);
  }, [isFixedHeader, isMultipleHeader, isWidthOverflow, props.bordered]);
  React.useImperativeHandle(ref, function () {
    return {
      tableElement: tableRef.current,
      tableHtmlElement: tableElmRef.current,
      tableContentElement: tableContentRef.current
    };
  });

  var onFixedChange = function onFixedChange() {
    var timer = setTimeout(function () {
      updateHeaderScroll();
      clearTimeout(timer);
    }, 0);
  };

  var onInnerScroll = onTableContentScroll;
  var newData = isPaginateData ? dataSource : data;
  var defaultColWidth = props.tableLayout === "fixed" && isWidthOverflow ? "100px" : void 0;
  var colgroup = /* @__PURE__ */React__default["default"].createElement("colgroup", null, ((spansAndLeafNodes === null || spansAndLeafNodes === void 0 ? void 0 : spansAndLeafNodes.leafColumns) || columns).map(function (col, index) {
    return /* @__PURE__ */React__default["default"].createElement("col", {
      key: col.colKey || index,
      style: {
        width: table_hooks_useStyle.formatCSSUnit(col.width) || defaultColWidth
      }
    });
  }));
  var affixedHeader = Boolean(props.headerAffixedTop && tableWidth) && /* @__PURE__ */React__default["default"].createElement("div", {
    ref: affixHeaderRef,
    style: {
      width: "".concat(tableWidth, "px"),
      opacity: Number(showAffixHeader)
    },
    className: classNames__default["default"](defineProperty._defineProperty({}, tableBaseClass.affixedHeaderElm, props.headerAffixedTop))
  }, /* @__PURE__ */React__default["default"].createElement("table", {
    className: classNames__default["default"](tableElmClasses),
    style: _objectSpread(_objectSpread({}, tableElementStyles), {}, {
      width: "".concat(tableWidth, "px")
    })
  }, colgroup, /* @__PURE__ */React__default["default"].createElement(table_THead["default"], {
    isFixedHeader: isFixedHeader,
    rowAndColFixedPosition: rowAndColFixedPosition,
    isMultipleHeader: isMultipleHeader,
    bordered: props.bordered,
    spansAndLeafNodes: spansAndLeafNodes,
    thList: thList,
    thWidthList: thWidthList
  })));

  var tableBodyProps = _objectSpread({
    rowAndColFixedPosition: rowAndColFixedPosition,
    showColumnShadow: showColumnShadow,
    data: newData,
    columns: spansAndLeafNodes.leafColumns,
    scroll: props.scroll,
    tableElm: tableRef.current,
    tableContentElm: tableContentRef.current,
    tableWidth: tableWidth,
    isWidthOverflow: isWidthOverflow,
    rowKey: props.rowKey || "id",
    renderExpandedRow: props.renderExpandedRow
  }, pick.pick_1(props, table_TBody.extendTableProps));

  var tableContent = /* @__PURE__ */React__default["default"].createElement("div", {
    ref: tableContentRef,
    className: tableBaseClass.content,
    style: tableContentStyles,
    onScroll: onInnerScroll
  }, /* @__PURE__ */React__default["default"].createElement("table", {
    ref: tableElmRef,
    className: classNames__default["default"](tableElmClasses),
    style: tableElementStyles
  }, colgroup, /* @__PURE__ */React__default["default"].createElement(table_THead["default"], {
    isFixedHeader: isFixedHeader,
    rowAndColFixedPosition: rowAndColFixedPosition,
    isMultipleHeader: isMultipleHeader,
    bordered: props.bordered,
    spansAndLeafNodes: spansAndLeafNodes,
    thList: thList
  }), /* @__PURE__ */React__default["default"].createElement(table_TBody["default"], _objectSpread({}, tableBodyProps)), /* @__PURE__ */React__default["default"].createElement(table_TFoot["default"], {
    rowKey: props.rowKey,
    isFixedHeader: isFixedHeader,
    rowAndColFixedPosition: rowAndColFixedPosition,
    footData: props.footData,
    columns: columns,
    rowAttributes: props.rowAttributes,
    rowClassName: props.rowClassName
  })));
  var loading = props.loading,
      loadingProps = props.loadingProps;
  var customLoadingText = loading;
  var loadingContent = loading !== void 0 && /* @__PURE__ */React__default["default"].createElement(loading_index.Loading, _objectSpread({
    loading: !!loading,
    text: customLoadingText,
    attach: function attach() {
      return tableRef.current;
    },
    showOverlay: true
  }, loadingProps));
  var topContent = props.topContent,
      bottomContent = props.bottomContent;
  return /* @__PURE__ */React__default["default"].createElement("div", {
    ref: tableRef,
    className: classNames__default["default"](dynamicBaseTableClasses),
    style: _objectSpread({
      position: "relative"
    }, style)
  }, !!topContent && /* @__PURE__ */React__default["default"].createElement("div", {
    className: tableBaseClass.topContent
  }, topContent), !!props.headerAffixedTop && (props.headerAffixedTop ? /* @__PURE__ */React__default["default"].createElement(affix_index.Affix, _objectSpread(_objectSpread({
    offsetTop: 0
  }, props.headerAffixProps), {}, {
    onFixedChange: onFixedChange
  }), affixedHeader) : isFixedHeader && affixedHeader), tableContent, loadingContent, showRightDivider && /* @__PURE__ */React__default["default"].createElement("div", {
    className: tableBaseClass.scrollbarDivider,
    style: {
      right: "".concat(scrollbarWidth, "px"),
      height: "".concat((_tableContentRef$curr = tableContentRef.current) === null || _tableContentRef$curr === void 0 ? void 0 : _tableContentRef$curr.offsetHeight, "px")
    }
  }), !!bottomContent && /* @__PURE__ */React__default["default"].createElement("div", {
    className: tableBaseClass.bottomContent
  }, bottomContent), renderPagination());
});
BaseTable.displayName = "BaseTable";

exports.BASE_TABLE_ALL_EVENTS = BASE_TABLE_ALL_EVENTS;
exports.BASE_TABLE_EVENTS = BASE_TABLE_EVENTS;
exports["default"] = BaseTable;
//# sourceMappingURL=BaseTable.js.map
