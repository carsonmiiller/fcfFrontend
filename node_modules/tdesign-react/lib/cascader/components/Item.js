/**
 * tdesign v0.34.4
 * (c) 2022 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var defineProperty = require('../../_chunks/dep-a1655de1.js');
var React = require('react');
var classNames = require('classnames');
var tdesignIconsReact = require('tdesign-icons-react');
var _util_useConfig = require('../../_util/useConfig.js');
var _util_useCommonClassName = require('../../_util/useCommonClassName.js');
var _util_useRipple = require('../../_util/useRipple.js');
var cascader_utils_item = require('../utils/item.js');
var cascader_utils_helper = require('../utils/helper.js');
var loading_index = require('../../loading/index.js');
var tooltip_Tooltip = require('../../tooltip/Tooltip.js');
var checkbox_CheckboxGroup = require('../../_chunks/dep-bc4205a0.js');
require('../../_chunks/dep-38a46f48.js');
require('../../_chunks/dep-8a149e9f.js');
require('../../_chunks/dep-3b69722d.js');
require('../../_chunks/dep-fde4d28a.js');
require('../../_chunks/dep-e266830c.js');
require('../../_chunks/dep-fcf32c81.js');
require('../../_chunks/dep-3405bda4.js');
require('../../_chunks/dep-15a4424e.js');
require('../../_chunks/dep-c40d75ac.js');
require('../../_chunks/dep-910dcfa3.js');
require('../../_chunks/dep-633a5671.js');
require('../../_chunks/dep-9c339ffc.js');
require('../../_chunks/dep-b1a67107.js');
require('../../_chunks/dep-ab43c961.js');
require('../../_chunks/dep-9cacaf01.js');
require('../../_chunks/dep-c72c7229.js');
require('../../_chunks/dep-8e0a771d.js');
require('../../_chunks/dep-c90cc28f.js');
require('../../_chunks/dep-542cc308.js');
require('../../_chunks/dep-c6637e11.js');
require('../../_common/js/global-config/locale/zh_CN.js');
require('../../config-provider/zh_CN_config.js');
require('../../_util/useAnimation.js');
require('../../_util/setStyle.js');
require('../../_util/dom.js');
require('raf');
require('../../_chunks/dep-1d819290.js');
require('../../_util/easing.js');
require('../../_chunks/dep-f6a4bdd5.js');
require('../../_chunks/dep-19841e1d.js');
require('../../loading/Loading.js');
require('../../_chunks/dep-3cf9becb.js');
require('../../common/Portal.js');
require('react-dom');
require('../../loading/gradient.js');
require('../../_common/js/loading/circle-adapter.js');
require('../../_common/js/utils/set-style.js');
require('../../_common/js/utils/helper.js');
require('../../_chunks/dep-23535a52.js');
require('../../loading/defaultProps.js');
require('../../loading/plugin.js');
require('../../popup/index.js');
require('../../popup/Popup.js');
require('react-transition-group');
require('react-popper');
require('../../hooks/useControlled.js');
require('../../_chunks/dep-f3090217.js');
require('../../_chunks/dep-d4a0b3f0.js');
require('../../_chunks/dep-6dfb2577.js');
require('../../_chunks/dep-86abec96.js');
require('../../_chunks/dep-cb0f33ac.js');
require('../../_util/noop.js');
require('../../_util/composeRefs.js');
require('../../popup/hooks/useTriggerProps.js');
require('../../_util/useClickOutside.js');
require('../../popup/utils/getTransitionParams.js');
require('../../_util/useMutationObserver.js');
require('../../_chunks/dep-85b3eaa4.js');
require('../../_chunks/dep-e19f22f6.js');
require('../../_util/useWindowSize.js');
require('../../popup/defaultProps.js');
require('../../tooltip/defaultProps.js');
require('../../_util/forwardRefWithStatics.js');
require('hoist-non-react-statics');
require('../../common/Check.js');
require('../../_util/helper.js');
require('../../_chunks/dep-e3db5727.js');
require('../../_chunks/dep-bc80a1a5.js');
require('../../checkbox/defaultProps.js');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var classNames__default = /*#__PURE__*/_interopDefaultLegacy(classNames);

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { defineProperty._defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

var RenderLabelInner = function RenderLabelInner(name, node, cascaderContext) {
  var filterActive = cascaderContext.filterActive,
      inputVal = cascaderContext.inputVal;
  var labelText = filterActive ? cascader_utils_helper.getFullPathLabel(node) : node.label;
  var isEllipsis = cascader_utils_item.getLabelIsEllipsis(labelText, cascaderContext.size);
  var EllipsisNode = isEllipsis ? /* @__PURE__ */React__default["default"].createElement("div", {
    className: "".concat(name, "-label--ellipsis")
  }, /* @__PURE__ */React__default["default"].createElement(tooltip_Tooltip["default"], {
    content: labelText,
    placement: "top-left"
  })) : null;

  if (filterActive) {
    var texts = labelText.split(inputVal);
    var doms = [];

    for (var index = 0; index < texts.length; index++) {
      doms.push( /* @__PURE__ */React__default["default"].createElement("span", {
        key: index
      }, texts[index]));
      if (index === texts.length - 1) break;
      doms.push( /* @__PURE__ */React__default["default"].createElement("span", {
        key: "".concat(index, "filter"),
        className: "".concat(name, "-label--filter")
      }, inputVal));
    }

    return /* @__PURE__ */React__default["default"].createElement(React__default["default"].Fragment, null, doms, EllipsisNode);
  }

  return /* @__PURE__ */React__default["default"].createElement(React__default["default"].Fragment, null, labelText, EllipsisNode);
};

var RenderLabelContent = function RenderLabelContent(node, cascaderContext) {
  var _useConfig = _util_useConfig["default"](),
      prefix = _useConfig.classPrefix;

  var name = "".concat(prefix, "-cascader__item");
  var label = RenderLabelInner(name, node, cascaderContext);
  return /* @__PURE__ */React__default["default"].createElement("span", {
    className: "".concat(name, "-label"),
    role: "label"
  }, label);
};

var RenderCheckBox = function RenderCheckBox(node, cascaderContext, handleChange) {
  var _useConfig2 = _util_useConfig["default"](),
      prefix = _useConfig2.classPrefix;

  var name = "".concat(prefix, "-cascader__item");
  var checkProps = cascaderContext.checkProps,
      value = cascaderContext.value,
      max = cascaderContext.max;
  var label = RenderLabelInner(name, node, cascaderContext);
  return /* @__PURE__ */React__default["default"].createElement(checkbox_CheckboxGroup.Checkbox, _objectSpread(_objectSpread({}, checkProps), {}, {
    checked: node.checked,
    indeterminate: node.indeterminate,
    disabled: node.isDisabled() || value && value.length >= max && max !== 0,
    name: node.value,
    onChange: handleChange
  }), label);
};

var Item = /*#__PURE__*/React.forwardRef(function (props, ref) {
  var node = props.node,
      _props$cascaderContex = props.cascaderContext,
      multiple = _props$cascaderContex.multiple,
      loadingText = _props$cascaderContex.loadingText,
      onClick = props.onClick,
      onChange = props.onChange,
      onMouseEnter = props.onMouseEnter,
      cascaderContext = props.cascaderContext;

  var _useConfig3 = _util_useConfig["default"](),
      prefix = _useConfig3.classPrefix;

  var itemRef = React.useRef();
  _util_useRipple["default"](ref || itemRef);
  var CLASSNAMES = _util_useCommonClassName["default"]();
  var itemClass = React.useMemo(function () {
    return classNames__default["default"](cascader_utils_item.getCascaderItemClass(prefix, node, CLASSNAMES, cascaderContext));
  }, [prefix, node, CLASSNAMES, cascaderContext]);
  var iconClass = React.useMemo(function () {
    return classNames__default["default"](cascader_utils_item.getCascaderItemIconClass(prefix, node, CLASSNAMES, cascaderContext));
  }, [prefix, node, CLASSNAMES, cascaderContext]);

  var handleClick = function handleClick(e) {
    var _e$nativeEvent, _e$nativeEvent$stopIm;

    e.stopPropagation();
    e === null || e === void 0 ? void 0 : (_e$nativeEvent = e.nativeEvent) === null || _e$nativeEvent === void 0 ? void 0 : (_e$nativeEvent$stopIm = _e$nativeEvent.stopImmediatePropagation) === null || _e$nativeEvent$stopIm === void 0 ? void 0 : _e$nativeEvent$stopIm.call(_e$nativeEvent);
    var ctx = {
      e: e,
      node: node
    };
    onClick(ctx);
  };

  var handleChange = function handleChange(e) {
    var ctx = {
      e: e,
      node: node
    };
    onChange(ctx);
  };

  var handleMouseenter = function handleMouseenter(e) {
    e.stopPropagation();
    var ctx = {
      e: e,
      node: node
    };
    onMouseEnter(ctx);
  };

  return /* @__PURE__ */React__default["default"].createElement("li", {
    ref: ref || itemRef,
    className: itemClass,
    onClick: handleClick,
    onMouseEnter: handleMouseenter
  }, multiple ? RenderCheckBox(node, cascaderContext, handleChange) : RenderLabelContent(node, cascaderContext), node.children && (node.loading ? /* @__PURE__ */React__default["default"].createElement(loading_index.Loading, {
    className: iconClass,
    loading: true,
    text: loadingText,
    size: "small"
  }) : /* @__PURE__ */React__default["default"].createElement(tdesignIconsReact.ChevronRightIcon, {
    className: iconClass
  })));
});

exports["default"] = Item;
//# sourceMappingURL=Item.js.map
