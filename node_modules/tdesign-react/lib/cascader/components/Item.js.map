{"version":3,"file":"Item.js","sources":["../../../src/cascader/components/Item.tsx"],"sourcesContent":["import React, { useRef, forwardRef, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { ChevronRightIcon } from 'tdesign-icons-react';\n\n// hook\nimport useConfig from '../../_util/useConfig';\nimport useCommonClassName from '../../_util/useCommonClassName';\nimport useRipple from '../../_util/useRipple';\n\n// common logic\nimport { getCascaderItemClass, getCascaderItemIconClass, getLabelIsEllipsis } from '../utils/item';\nimport { getFullPathLabel } from '../utils/helper';\n\n// component\nimport TLoading from '../../loading';\nimport Tooltip from '../../tooltip/Tooltip';\nimport Checkbox from '../../checkbox/Checkbox';\n\n// type\nimport { ContextType, CascaderItemProps, CascaderContextType } from '../interface';\nimport TreeNode from '../../_common/js/tree/tree-node';\nimport { TreeNodeValue } from '../../_common/js/tree/types';\nimport { CheckboxProps } from '../../checkbox';\n\nconst RenderLabelInner = (name: string, node: TreeNode, cascaderContext: CascaderContextType) => {\n  const { filterActive, inputVal } = cascaderContext;\n  const labelText = filterActive ? getFullPathLabel(node) : node.label;\n  const isEllipsis = getLabelIsEllipsis(labelText, cascaderContext.size);\n  const EllipsisNode = isEllipsis ? (\n    <div className={`${name}-label--ellipsis`}>\n      <Tooltip content={labelText} placement=\"top-left\" />\n    </div>\n  ) : null;\n\n  if (filterActive) {\n    const texts = labelText.split(inputVal);\n    const doms = [];\n    for (let index = 0; index < texts.length; index++) {\n      doms.push(<span key={index}>{texts[index]}</span>);\n      if (index === texts.length - 1) break;\n      doms.push(\n        <span key={`${index}filter`} className={`${name}-label--filter`}>\n          {inputVal}\n        </span>,\n      );\n    }\n    return (\n      <>\n        {doms}\n        {EllipsisNode}\n      </>\n    );\n  }\n  return (\n    <>\n      {labelText}\n      {EllipsisNode}\n    </>\n  );\n};\n\nconst RenderLabelContent = (node: TreeNode, cascaderContext: CascaderContextType) => {\n  const { classPrefix: prefix } = useConfig();\n  const name = `${prefix}-cascader__item`;\n\n  const label = RenderLabelInner(name, node, cascaderContext);\n\n  return (\n    <span className={`${name}-label`} role=\"label\">\n      {label}\n    </span>\n  );\n};\n\nconst RenderCheckBox = (node: TreeNode, cascaderContext: CascaderContextType, handleChange) => {\n  const { classPrefix: prefix } = useConfig();\n  const name = `${prefix}-cascader__item`;\n\n  const { checkProps, value, max } = cascaderContext;\n  const label = RenderLabelInner(name, node, cascaderContext);\n  return (\n    <Checkbox\n      {...checkProps}\n      checked={node.checked}\n      indeterminate={node.indeterminate}\n      disabled={node.isDisabled() || (value && (value as TreeNodeValue[]).length >= max && max !== 0)}\n      name={node.value}\n      onChange={handleChange}\n    >\n      {label}\n    </Checkbox>\n  );\n};\n\nconst Item = forwardRef((props: CascaderItemProps, ref: React.RefObject<HTMLLIElement>) => {\n  const {\n    node,\n    cascaderContext: { multiple, loadingText },\n    onClick,\n    onChange,\n    onMouseEnter,\n    cascaderContext,\n  } = props;\n  const { classPrefix: prefix } = useConfig();\n\n  const itemRef = useRef();\n  useRipple(ref || itemRef);\n\n  /**\n   * class\n   */\n  const CLASSNAMES = useCommonClassName();\n\n  const itemClass = useMemo(\n    () => classNames(getCascaderItemClass(prefix, node, CLASSNAMES, cascaderContext)),\n    [prefix, node, CLASSNAMES, cascaderContext],\n  );\n\n  const iconClass = useMemo(\n    () => classNames(getCascaderItemIconClass(prefix, node, CLASSNAMES, cascaderContext)),\n    [prefix, node, CLASSNAMES, cascaderContext],\n  );\n\n  const handleClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    e?.nativeEvent?.stopImmediatePropagation?.();\n    const ctx: ContextType = {\n      e,\n      node,\n    };\n    onClick(ctx);\n  };\n\n  const handleChange: CheckboxProps['onChange'] = (e) => {\n    const ctx = {\n      e,\n      node,\n    };\n    onChange(ctx);\n  };\n\n  const handleMouseenter = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    const ctx: ContextType = {\n      e,\n      node,\n    };\n    onMouseEnter(ctx);\n  };\n\n  return (\n    <li ref={ref || itemRef} className={itemClass} onClick={handleClick} onMouseEnter={handleMouseenter}>\n      {multiple ? RenderCheckBox(node, cascaderContext, handleChange) : RenderLabelContent(node, cascaderContext)}\n      {node.children &&\n        (node.loading ? (\n          <TLoading className={iconClass} loading={true} text={loadingText} size=\"small\" />\n        ) : (\n          <ChevronRightIcon className={iconClass} />\n        ))}\n    </li>\n  );\n});\n\nexport default Item;\n"],"names":["RenderLabelInner","name","node","cascaderContext","filterActive","inputVal","labelText","getFullPathLabel","label","isEllipsis","getLabelIsEllipsis","size","EllipsisNode","React","createElement","className","Tooltip","content","placement","texts","split","doms","index","length","push","key","Fragment","RenderLabelContent","useConfig","prefix","classPrefix","role","RenderCheckBox","handleChange","checkProps","value","max","Checkbox","checked","indeterminate","disabled","isDisabled","onChange","Item","forwardRef","props","ref","multiple","loadingText","onClick","onMouseEnter","itemRef","useRef","useRipple","CLASSNAMES","useCommonClassName","itemClass","useMemo","classNames","getCascaderItemClass","iconClass","getCascaderItemIconClass","handleClick","e","stopPropagation","nativeEvent","stopImmediatePropagation","ctx","handleMouseenter","children","loading","TLoading","text","ChevronRightIcon"],"mappings":"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"}