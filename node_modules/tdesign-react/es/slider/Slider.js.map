{"version":3,"file":"Slider.js","sources":["../../src/slider/Slider.tsx"],"sourcesContent":["import React, { forwardRef, useMemo, useRef } from 'react';\nimport classNames from 'classnames';\nimport isFunction from 'lodash/isFunction';\nimport isString from 'lodash/isString';\nimport { TdSliderProps } from './type';\nimport useConfig from '../_util/useConfig';\nimport useControlled from '../hooks/useControlled';\nimport { numberToPercent } from './utils/handleNumber';\nimport { StyledProps, TNode } from '../common';\nimport InputNumber from '../input-number/InputNumber';\nimport SliderHandleButton from './SliderHandleButton';\nimport { accAdd } from '../_util/number';\nimport { sliderDefaultProps } from './defaultProps';\n\nexport type SliderProps = TdSliderProps & StyledProps;\n\nconst LEFT_NODE = 0;\nconst RIGHT_NODE = 1;\ntype SliderHandleNode = typeof LEFT_NODE | typeof RIGHT_NODE;\n\nconst Slider = forwardRef((props: SliderProps, ref: React.Ref<HTMLDivElement>) => {\n  const { classPrefix } = useConfig();\n  const { disabled, inputNumberProps, label, layout, marks, max, min, range, step, tooltipProps, className, style } =\n    props;\n\n  const sliderRef = useRef<HTMLDivElement>();\n  const [value, onChange] = useControlled(props, 'value', props.onChange);\n  const isVertical = layout === 'vertical';\n\n  const renderValue = Array.isArray(value) ? value : [min, value];\n  const start = (renderValue[LEFT_NODE] - min) / (max - min);\n  const width = (renderValue[RIGHT_NODE] - renderValue[LEFT_NODE]) / (max - min);\n  const end = start + width;\n\n  const dots: { value: number; label: TNode; position: number }[] = useMemo(() => {\n    // 当 marks 为数字数组\n    if (Array.isArray(marks)) {\n      if (marks.some((mark) => typeof mark !== 'number')) {\n        console.warn('The props \"marks\" only support number!');\n        return [];\n      }\n      return marks.map((mark) => ({\n        value: mark,\n        position: (mark - min) / (max - min),\n        label: mark,\n      }));\n    }\n    // 当 marks 为对象\n    if (marks && typeof marks === 'object') {\n      const result = [];\n      Object.keys(marks).forEach((key) => {\n        const numberKey = Number(key);\n        if (typeof numberKey !== 'number') {\n          console.warn('The props \"marks\" key only support number!');\n        } else {\n          result.push({\n            value: numberKey,\n            label: marks[numberKey],\n            position: (numberKey - min) / max,\n          });\n        }\n      });\n      return result;\n    }\n    return [];\n  }, [max, min, marks]);\n\n  const allDots = useMemo(() => {\n    // 默认\n    const result = [];\n    for (let i = min; i <= max; i = accAdd(i, step)) {\n      result.push({\n        value: i,\n        position: (i - min) / (max - min),\n      });\n    }\n    return result;\n  }, [max, min, step]);\n\n  const startDirection = isVertical ? 'bottom' : 'left';\n  const stepDirection = isVertical ? 'top' : 'left';\n  const sizeKey = isVertical ? 'height' : 'width';\n  const renderDots = isVertical ? dots.map((item) => ({ ...item, position: 1 - item.position })) : dots;\n\n  const handleInputChange = (newValue: number, nodeIndex: SliderHandleNode) => {\n    const safeValue = Number(newValue.toFixed(32));\n    let resultValue = Math.max(Math.min(max, safeValue), min);\n    // 判断是否出现左值大于右值\n    if (nodeIndex === LEFT_NODE && safeValue > value[RIGHT_NODE]) resultValue = value[RIGHT_NODE];\n    // 判断是否出现右值大于左值\n    if (nodeIndex === RIGHT_NODE && safeValue < value[LEFT_NODE]) resultValue = value[LEFT_NODE];\n    if (Array.isArray(value)) {\n      const arrValue = value.slice();\n      arrValue[nodeIndex] = resultValue;\n      onChange(arrValue);\n    } else {\n      onChange(resultValue);\n    }\n  };\n\n  const createInput = (nodeIndex: SliderHandleNode) => {\n    const inputProps = typeof inputNumberProps === 'object' ? inputNumberProps : {};\n    const currentValue = renderValue[nodeIndex];\n\n    return (\n      <InputNumber\n        value={currentValue}\n        onChange={(v: number) => {\n          if (typeof v !== 'undefined') {\n            handleInputChange(Number(v), nodeIndex);\n          }\n        }}\n        className={classNames(`${classPrefix}-slider-input`, {\n          'is-vertical': isVertical,\n        })}\n        disabled={disabled}\n        {...inputProps}\n        theme=\"column\"\n      />\n    );\n  };\n\n  const nearbyValueChange = (value: number) => {\n    const buttonBias =\n      Math.abs(value - renderValue[LEFT_NODE]) > Math.abs(value - renderValue[RIGHT_NODE]) ? RIGHT_NODE : LEFT_NODE;\n    handleInputChange(value, buttonBias);\n  };\n\n  const setPosition = (position: number, nodeIndex?: SliderHandleNode) => {\n    let index = 0;\n    let minDistance = 1;\n    for (let i = 0; i < allDots.length; i++) {\n      const diff = Math.abs(allDots[i].position - position);\n      if (minDistance > diff) {\n        index = i;\n        minDistance = diff;\n      }\n    }\n    const { value } = allDots[index];\n    if (nodeIndex === undefined && range) {\n      nearbyValueChange(value);\n    } else {\n      handleInputChange(value, nodeIndex);\n    }\n  };\n\n  const onSliderChange = (event: React.MouseEvent | MouseEvent, nodeIndex?: SliderHandleNode) => {\n    if (disabled) return;\n    const clientKey = isVertical ? 'clientY' : 'clientX';\n    const sliderPositionInfo = sliderRef.current.getBoundingClientRect();\n    const sliderOffset = sliderPositionInfo[startDirection];\n    const position = ((event[clientKey] - sliderOffset) / sliderPositionInfo[sizeKey]) * (isVertical ? -1 : 1);\n    setPosition(position, nodeIndex);\n  };\n\n  const handleClickMarks = (event: React.MouseEvent, value: number) => {\n    event.stopPropagation();\n    nearbyValueChange(value);\n  };\n\n  const createHandleButton = (nodeIndex: SliderHandleNode, style: React.CSSProperties) => {\n    const currentValue = renderValue[nodeIndex];\n    // 模板替换\n    let tipLabel: React.ReactNode = currentValue;\n    if (isFunction(label))\n      tipLabel = label({ value: currentValue, position: nodeIndex === LEFT_NODE ? 'start' : 'end' });\n    if (isString(label)) tipLabel = label.replace(/\\$\\{value\\}/g, currentValue.toString());\n\n    return (\n      <SliderHandleButton\n        toolTipProps={{\n          content: tipLabel,\n          ...tooltipProps,\n        }}\n        hideTips={label === false}\n        classPrefix={classPrefix}\n        style={style}\n        onChange={(e) => onSliderChange(e, nodeIndex)}\n      />\n    );\n  };\n\n  return (\n    <div\n      style={{ ...style }}\n      className={classNames(`${classPrefix}-slider__container`, {\n        'is-vertical': isVertical,\n      })}\n      ref={ref}\n    >\n      <div\n        ref={sliderRef}\n        className={classNames(className, `${classPrefix}-slider`, {\n          [`${classPrefix}-is-disabled`]: disabled,\n          [`${classPrefix}-slider--vertical`]: isVertical,\n          [`${classPrefix}-slider--with-input`]: inputNumberProps,\n        })}\n        onClick={onSliderChange}\n      >\n        <div className={classNames(`${classPrefix}-slider__rail`)}>\n          <div\n            style={{ [startDirection]: numberToPercent(start), [sizeKey]: numberToPercent(width) }}\n            className={classNames(`${classPrefix}-slider__track`)}\n          ></div>\n          {range ? createHandleButton(LEFT_NODE, { [startDirection]: numberToPercent(start) }) : null}\n          {createHandleButton(RIGHT_NODE, { [startDirection]: numberToPercent(end) })}\n          <div>\n            {renderDots.map(({ position, value }) => (\n              <div\n                key={value}\n                style={{ [stepDirection]: numberToPercent(position) }}\n                className={classNames(`${classPrefix}-slider__stop`)}\n              ></div>\n            ))}\n          </div>\n          <div className={classNames(`${classPrefix}-slider__mark`)}>\n            {renderDots.map(({ position, value, label }) => (\n              <div\n                key={value}\n                onClick={(event) => handleClickMarks(event, value)}\n                style={{ [stepDirection]: numberToPercent(position) }}\n                className={classNames(`${classPrefix}-slider__mark-text`)}\n              >\n                {label}\n              </div>\n            ))}\n          </div>\n        </div>\n      </div>\n      {inputNumberProps ? (\n        <div\n          className={classNames(`${classPrefix}-slider__input-container`, {\n            'is-vertical': isVertical,\n          })}\n        >\n          {range && createInput(LEFT_NODE)}\n          {range && <div className={`${classPrefix}-slider__center-line`}></div>}\n          {createInput(RIGHT_NODE)}\n        </div>\n      ) : null}\n    </div>\n  );\n});\n\nSlider.displayName = 'Slider';\nSlider.defaultProps = sliderDefaultProps;\n\nexport default Slider;\n"],"names":["LEFT_NODE","RIGHT_NODE","Slider","forwardRef","props","ref","useConfig","classPrefix","disabled","inputNumberProps","label","layout","marks","max","min","range","step","tooltipProps","className","style","sliderRef","useRef","useControlled","onChange","value","isVertical","renderValue","Array","isArray","start","width","end","dots","useMemo","some","mark","console","warn","map","position","result","Object","keys","forEach","key","numberKey","Number","push","allDots","i","accAdd","startDirection","stepDirection","sizeKey","renderDots","item","handleInputChange","newValue","nodeIndex","safeValue","toFixed","resultValue","Math","arrValue","slice","createInput","inputProps","currentValue","React","createElement","InputNumber","v","classNames","theme","nearbyValueChange","value2","buttonBias","abs","setPosition","index","minDistance","length","diff","onSliderChange","event","clientKey","sliderPositionInfo","current","getBoundingClientRect","sliderOffset","handleClickMarks","stopPropagation","createHandleButton","style2","tipLabel","isFunction","isString","replace","toString","SliderHandleButton","toolTipProps","content","hideTips","e","onClick","numberToPercent","label2","displayName","defaultProps","sliderDefaultProps"],"mappings":"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"}