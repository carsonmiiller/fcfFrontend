{"version":3,"file":"TransferList.js","sources":["../../src/transfer/TransferList.tsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\nimport classnames from 'classnames';\nimport isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport isString from 'lodash/isString';\nimport { SearchIcon } from 'tdesign-icons-react';\nimport { getLeafNodes } from './utils';\nimport useConfig from '../_util/useConfig';\nimport { TdTransferProps, TransferValue } from './type';\nimport { TNode, StyledProps } from '../common';\nimport Checkbox from '../checkbox';\nimport Input from '../input';\nimport Pagination, { PaginationProps } from '../pagination';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\n\ninterface TransferListProps\n  extends Pick<TdTransferProps, 'data' | 'search' | 'checked' | 'transferItem' | 'tree'>,\n    StyledProps {\n  disabled?: boolean;\n  empty?: TNode | string;\n  title?: TNode;\n  footer?: TNode;\n  content?: TNode;\n  pagination?: Pick<PaginationProps, 'pageSize'> & { onPageChange?: (current: number) => void };\n  onCheckbox?: (checked: Array<TransferValue>) => void;\n  onSearch?: (value: string) => void;\n}\n\nconst TransferList: React.FunctionComponent<TransferListProps> = (props) => {\n  const {\n    className,\n    style,\n    data,\n    search = false,\n    checked = [],\n    empty,\n    title,\n    footer,\n    content,\n    onCheckbox,\n    onSearch,\n    disabled = false,\n    pagination,\n    transferItem,\n    tree: treeNode,\n  } = props;\n  const notDisabledData = !treeNode\n    ? data.filter((item) => !item.disabled)\n    : getLeafNodes(data).filter((item) => !item.disabled);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n\n  const [indeterminate, allChecked] = useMemo(() => {\n    const activeLen = checked.length;\n    const notLen = notDisabledData.length;\n    return [activeLen && activeLen < notLen, activeLen && activeLen === notLen];\n  }, [checked, notDisabledData]);\n\n  const { classPrefix } = useConfig();\n  const CLASSPREFIX = `${classPrefix}-transfer__list`;\n  const [local, t] = useLocaleReceiver('transfer');\n\n  const handleCheckbox = (vals: Array<TransferValue>) => {\n    if (isFunction(onCheckbox)) onCheckbox(vals);\n  };\n\n  const handleAllCheckbox = (checked: boolean) => {\n    if (isFunction(onCheckbox)) onCheckbox(checked ? notDisabledData.map((item) => item.value) : []);\n  };\n\n  const HeaderCmp = () => {\n    const total = treeNode ? getLeafNodes(data).length : data.length;\n    return (\n      <div className={`${CLASSPREFIX}-header`}>\n        <div>\n          <Checkbox\n            indeterminate={indeterminate}\n            checked={allChecked}\n            disabled={disabled}\n            onChange={handleAllCheckbox}\n          ></Checkbox>\n          <span>{t(local.title, { checked: checked.length, total })}</span>\n        </div>\n        <span>{title}</span>\n      </div>\n    );\n  };\n\n  const SearchCmp = () =>\n    search ? (\n      <div className={`${classPrefix}-transfer__search-wrapper`}>\n        <Input placeholder={local.placeholder} suffixIcon={<SearchIcon></SearchIcon>} onChange={onSearch}></Input>\n      </div>\n    ) : null;\n\n  const viewData = useMemo(() => {\n    if (!isEmpty(pagination)) {\n      const pageSize = pagination.pageSize || 10;\n      const start = (currentPage - 1) * pageSize;\n      return data.slice(start, start + pageSize);\n    }\n    return data;\n  }, [currentPage, data, pagination]);\n\n  const EmptyCmp = () =>\n    isString(empty) ? (\n      <div className={`${classPrefix}-transfer__empty`}>\n        <span>{empty || '暂无数据'}</span>\n      </div>\n    ) : (\n      empty\n    );\n\n  const contentCmp = () => {\n    if (typeof treeNode === 'function') {\n      return treeNode({ data: viewData, value: checked, onChange: handleCheckbox });\n    }\n    if (typeof content === 'function') {\n      return content({ data: viewData });\n    }\n    return (\n      <Checkbox.Group value={checked} onChange={handleCheckbox} disabled={disabled}>\n        {viewData.map((item, index) => (\n          <Checkbox key={item.value} value={item.value} disabled={item.disabled} className={`${CLASSPREFIX}-item`}>\n            <span>\n              {typeof transferItem === 'function' ? transferItem({ data: item, index, type: 'source' }) : item.label}\n            </span>\n          </Checkbox>\n        ))}\n      </Checkbox.Group>\n    );\n  };\n  const BodyCmp = () => (\n    <div\n      className={classnames(`${CLASSPREFIX}-body`, {\n        [`${CLASSPREFIX}--with-search`]: search,\n      })}\n    >\n      {SearchCmp()}\n      <div className={`${CLASSPREFIX}-content narrow-scrollbar`}>{viewData.length ? contentCmp() : EmptyCmp()}</div>\n    </div>\n  );\n\n  const PaginationCmp = () => {\n    const handleCurrentPagination = (current: number) => {\n      setCurrentPage(current);\n      if (isFunction(pagination.onPageChange)) {\n        pagination.onPageChange(current);\n      }\n    };\n\n    return pagination ? (\n      <div className={`${CLASSPREFIX}-pagination`}>\n        <Pagination\n          size=\"small\"\n          theme=\"simple\"\n          pageSizeOptions={[]}\n          total={data.length}\n          totalContent={false}\n          onCurrentChange={handleCurrentPagination}\n          pageSize={pagination.pageSize}\n        />\n      </div>\n    ) : null;\n  };\n\n  const footerCmp = () => (!isEmpty(footer) ? <div className={`${classPrefix}-transfer__footer`}>{footer}</div> : null);\n\n  return (\n    <div style={style} className={classnames(CLASSPREFIX, className)}>\n      {HeaderCmp()}\n      {BodyCmp()}\n      {PaginationCmp()}\n      {footerCmp()}\n    </div>\n  );\n};\n\nexport default TransferList;\n"],"names":["TransferList","props","className","style","data","search","checked","empty","title","footer","content","onCheckbox","onSearch","disabled","pagination","transferItem","treeNode","tree","notDisabledData","filter","item","getLeafNodes","useState","currentPage","setCurrentPage","useMemo","activeLen","length","notLen","indeterminate","allChecked","useConfig","classPrefix","CLASSPREFIX","useLocaleReceiver","local","t","handleCheckbox","vals","isFunction","handleAllCheckbox","checked2","map","value","HeaderCmp","total","React","createElement","Checkbox","onChange","SearchCmp","Input","placeholder","suffixIcon","SearchIcon","viewData","isEmpty","pageSize","start","slice","EmptyCmp","isString","contentCmp","Group","index","key","type","label","BodyCmp","classnames","PaginationCmp","handleCurrentPagination","current","onPageChange","Pagination","size","theme","pageSizeOptions","totalContent","onCurrentChange","footerCmp"],"mappings":"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"}