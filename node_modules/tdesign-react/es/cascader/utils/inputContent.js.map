{"version":3,"file":"inputContent.js","sources":["../../../src/cascader/utils/inputContent.ts"],"sourcesContent":["import isFunction from 'lodash/isFunction';\nimport isEmpty from 'lodash/isEmpty';\nimport { TreeNode, CascaderContextType, TreeNodeValue, CascaderProps } from '../interface';\nimport { isInPage } from './helper';\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCloseIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { visible, disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.visible]: visible,\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * icon Class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getFakeArrowIconClass(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { disabled } = cascaderContext;\n  return [\n    `${prefix}-cascader__icon`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n    },\n  ];\n}\n\n/**\n * Cascader外显div class\n * @param prefix\n * @param CLASSNAMES\n * @param cascaderContext\n * @returns\n */\nexport function getCascaderInnerClasses(prefix: string, CLASSNAMES: any, cascaderContext: CascaderContextType) {\n  const { disabled, visible, size, multiple } = cascaderContext;\n  return [\n    `${prefix}-cascader`,\n    {\n      [CLASSNAMES.STATUS.disabled]: disabled,\n      [CLASSNAMES.STATUS.active]: visible,\n      [CLASSNAMES.SIZE[size]]: size,\n      [`${prefix}-cascader--multiple`]: multiple,\n    },\n  ];\n}\n\n/**\n * closeIcon 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getCloseShow(isHover: boolean, cascaderContext: CascaderContextType) {\n  const { value, disabled, clearable, visible } = cascaderContext;\n  return !!(!visible && clearable && isHover && !disabled && !isEmpty(value));\n}\n\n/**\n * Placeholder 是否显示\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getPlaceholderShow(\n  cascaderContext: CascaderContextType,\n  singleContent: string,\n  multipleContent: TreeNode[],\n) {\n  const { filterable, visible, multiple } = cascaderContext;\n  const valEmpty = !(multiple ? multipleContent.length : singleContent);\n  if (filterable) {\n    return valEmpty && !visible;\n  }\n  return valEmpty;\n}\n\n/**\n * 单选状态下内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getSingleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore, showAllLevels } = cascaderContext;\n  if (multiple || !value) return '';\n  if (Array.isArray(value)) return '';\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!(node && node.length)) {\n    // 无匹配数据直接输出\n    return value as string;\n  }\n  const path = node && node[0].getPath();\n  if (path && path.length) {\n    return showAllLevels ? path.map((node: TreeNode) => node.label).join(' / ') : path[path.length - 1].label;\n  }\n  return value as string;\n}\n\n/**\n * 多选状态下选中内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getMultipleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore } = cascaderContext;\n\n  if (!multiple) return [];\n  if (multiple && !Array.isArray(value)) return [];\n\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!node) return [];\n\n  const path = (value as TreeNodeValue[]).map((item: TreeNodeValue) => {\n    const node = treeStore.getNodes(item);\n    return node[0];\n  });\n  if (value && (value as TreeNodeValue[]).length) {\n    return path && path.length ? path : (value as TreeNode[]);\n  }\n  return [];\n}\n\n/**\n * 点击popup outside副作用\n * @param ref\n * @param cascaderContext\n * @param event\n * @returns\n */\nexport function outerClickListenerEffect(\n  ref: HTMLElement,\n  cascaderContext: CascaderContextType,\n  event: MouseEvent | TouchEvent,\n) {\n  const { visible, setVisible } = cascaderContext;\n  const target = event.target as Node;\n  // 可能点击的dom在判断的时候已经被移除了\n  if (!visible || !ref || ref.contains(target) || !isInPage(target)) return;\n  setVisible(false);\n}\n\n/**\n * closeIcon点击副作用\n * @param cascaderContext\n */\nexport function closeIconClickEffect(cascaderContext: CascaderContextType) {\n  const { setVisible, multiple, setExpend, setValue } = cascaderContext;\n\n  setVisible(false);\n\n  // 手动设置的展开需要去除\n  if (multiple) {\n    setExpend([]);\n  }\n\n  setValue(multiple ? [] : '', 'clear');\n}\n\n/**\n * tag 关闭按钮点击副作用\n * @param cascaderContext\n */\nexport function handleRemoveTagEffect(\n  cascaderContext: CascaderContextType,\n  node: TreeNode,\n  onRemove: CascaderProps['onRemove'],\n) {\n  const { disabled, setValue } = cascaderContext;\n\n  if (disabled) return;\n  const checked = node.setChecked(!node.isChecked());\n  setValue(checked, 'uncheck', node.getModel());\n  if (isFunction(onRemove)) {\n    onRemove({ value: checked, node: node as any });\n  }\n}\n\n/**\n * 外显content点击副作用\n * @param cascaderContext\n */\nexport function innerContentClickEffect(cascaderContext: CascaderContextType) {\n  const { setVisible, visible, filterActive, disabled } = cascaderContext;\n\n  if (!disabled) {\n    if (visible && filterActive) return; // input filter is active\n    setVisible(!visible);\n  }\n}\n"],"names":["getCloseIconClass","prefix","CLASSNAMES","cascaderContext","visible","disabled","STATUS","getFakeArrowIconClass","getCascaderInnerClasses","size","multiple","active","SIZE","getCloseShow","isHover","value","clearable","isEmpty","getPlaceholderShow","singleContent","multipleContent","filterable","valEmpty","length","getSingleContent","treeStore","showAllLevels","Array","isArray","node","getNodes","path","getPath","map","node2","label","join","getMultipleContent","item","outerClickListenerEffect","ref","event","setVisible","target","contains","isInPage","closeIconClickEffect","setExpend","setValue","handleRemoveTagEffect","onRemove","checked","setChecked","isChecked","getModel","isFunction","innerContentClickEffect","filterActive"],"mappings":"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"}