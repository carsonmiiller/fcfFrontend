{"version":3,"file":"base.js","sources":["../../../../src/_common/js/tabs/base.ts"],"sourcesContent":["const getDomWidth = (dom: HTMLElement): number => dom?.offsetWidth || 0;\n\ntype navPlacement = 'left' | 'right' | 'top' | 'bottom';\n\nexport interface allElementDeps {\n  activeTab?: HTMLElement;\n  navsContainer?: HTMLElement;\n  navsWrap?: HTMLElement;\n  leftOperations?: HTMLElement;\n  toLeftBtn?: HTMLElement;\n  rightOperations?: HTMLElement;\n  toRightBtn?: HTMLElement;\n}\n\nexport default {\n  /**\n   * 计算滚动条的当前偏移值，用于 resize 时调整\n   * @returns number\n   */\n  calcScrollLeft(elements: allElementDeps, scrollLeft: number): number {\n    const container = elements.navsContainer;\n    const wrap = elements.navsWrap;\n    const { rightOperations } = elements;\n    const rightOperationsZoneWidth = getDomWidth(rightOperations);\n\n    if (!wrap || !container) return scrollLeft;\n\n    const containerWidth = getDomWidth(container);\n    const wrapWidth = getDomWidth(wrap);\n\n    if (wrapWidth <= containerWidth) { // 容器大于选项，则设置第一个 nav-item 和容器左边相连\n      return 0;\n    }\n\n    // 一般发生在 window.resize，容器变大，此时设置最后一个 nav-item 和容器右边相连\n    if (scrollLeft + containerWidth - rightOperationsZoneWidth > wrapWidth) {\n      return wrapWidth + rightOperationsZoneWidth - containerWidth;\n    }\n\n    return scrollLeft;\n  },\n\n  /**\n   * 计算往左滚动按钮是否应该出现\n   * @param depElement 计算时依赖的元素\n   * @param scrollLeft 当前的 scrollLeft\n   * @param placement navs 的位置\n   * @returns boolean\n   */\n  calculateCanToLeft(depElement: allElementDeps, scrollLeft: number, placement: navPlacement) {\n    if (['left', 'right'].includes(placement.toLowerCase())) {\n      return false;\n    }\n    const {\n      navsContainer: container, navsWrap: wrap, leftOperations, toLeftBtn\n    } = depElement;\n    if (!wrap || !container) {\n      return false;\n    }\n    const leftOperationsZoneWidth = getDomWidth(leftOperations);\n    const leftIconWidth = getDomWidth(toLeftBtn);\n\n    return scrollLeft + Math.round(leftOperationsZoneWidth - leftIconWidth) > 0;\n  },\n\n  /**\n   * 计算往右滚动按钮是否应该出现\n   * @param depElement 计算时依赖的元素\n   * @param scrollLeft 当前的偏移值\n   * @param placement navs 的位置\n   * @returns boolean\n   */\n  calculateCanToRight(depElement: allElementDeps, scrollLeft: number, placement: navPlacement) {\n    if (['left', 'right'].includes(placement.toLowerCase())) {\n      return false;\n    }\n    const {\n      navsContainer: container, navsWrap: wrap, rightOperations, toRightBtn\n    } = depElement;\n    if (!wrap || !container) {\n      return false;\n    }\n    const rightOperationsZoneWidth = getDomWidth(rightOperations);\n    const rightIconWidth = getDomWidth(toRightBtn);\n    return scrollLeft\n        + getDomWidth(container)\n        - (rightOperationsZoneWidth - rightIconWidth)\n        - getDomWidth(wrap)\n        < -1; // 小数像素不精确，所以这里判断小于-1\n  },\n\n  /**\n   * 计算将当前 tab 滚动到可视区域的偏移值\n   * @param depElement 计算时依赖的元素\n   * @param scrollLeft 当前的偏移值\n   * @returns number\n   */\n  moveActiveTabIntoView(depElement: allElementDeps, scrollLeft: number): number {\n    const {\n      activeTab, navsContainer: container, navsWrap,\n      leftOperations, toLeftBtn, rightOperations, toRightBtn\n    } = depElement;\n    if (!activeTab) return scrollLeft;\n    const totalWidthBeforeActiveTab = activeTab.offsetLeft;\n    if (!container) return scrollLeft;\n    // 如果要当前tab左边对齐左操作栏的右边以展示完整的tab，需要获取左边操作栏的宽度\n    const _getLeftCoverWidth = () => {\n      const leftOperationsZoneWidth = getDomWidth(leftOperations);\n      const leftIconWidth = getDomWidth(toLeftBtn);\n      // 判断当前tab是不是第一个tab\n      if (totalWidthBeforeActiveTab === 0) {\n        // 如果是第一个tab要移动到最左边，则要减去左箭头的宽度，因为此时左箭头会被隐藏起来\n        return leftOperationsZoneWidth - leftIconWidth;\n      }\n      return leftOperationsZoneWidth;\n    };\n    const leftCoverWidth = _getLeftCoverWidth();\n    // 判断当前tab是不是在左边被隐藏\n    const isCurrentTabHiddenInLeftZone = scrollLeft + leftCoverWidth > totalWidthBeforeActiveTab;\n    if (isCurrentTabHiddenInLeftZone) {\n      return totalWidthBeforeActiveTab - leftCoverWidth;\n    }\n\n    // move to right\n    const activeTabWidth = activeTab.offsetWidth;\n    if (!container || !navsWrap) return scrollLeft;\n    const containerWidth = getDomWidth(container);\n    // 如果要当前tab右边对齐右操作栏的左边以展示完整的tab，需要获取右边操作栏的宽度\n    const _getRightCoverWidth = () => {\n      const rightOperationsZoneWidth = getDomWidth(rightOperations);\n      const rightIconWidth = getDomWidth(toRightBtn);\n      const wrapWidth = getDomWidth(navsWrap);\n      // 判断当前tab是不是最后一个tab，小于1是防止小数像素导致值不相等的情况\n      if (Math.abs(totalWidthBeforeActiveTab + activeTabWidth - wrapWidth) < 1) {\n        // 如果是最后一个tab，则要减去右箭头的宽度，因为此时右箭头会被隐藏\n        return rightOperationsZoneWidth - rightIconWidth;\n      }\n      return rightOperationsZoneWidth;\n    };\n    const rightCoverWidth = _getRightCoverWidth();\n    // 判断当前tab是不是在右边被隐藏\n    const isHiddenInRightZone = scrollLeft + containerWidth - rightCoverWidth\n        < totalWidthBeforeActiveTab + activeTabWidth;\n    if (isHiddenInRightZone) {\n      return totalWidthBeforeActiveTab + activeTabWidth - containerWidth + rightCoverWidth;\n    }\n    return scrollLeft;\n  },\n\n  /**\n   * 计算点击“往左按钮”时，需要的偏移值\n   * @param depElement 计算时依赖的元素\n   * @param scrollLeft 当前的偏移值\n   * @returns number\n   */\n  scrollToLeft(depElement: allElementDeps, scrollLeft: number): number {\n    const { navsContainer: container, leftOperations, toLeftBtn } = depElement;\n    if (!container) return 0;\n    const leftOperationsZoneWidth = getDomWidth(leftOperations);\n    const leftIconWidth = getDomWidth(toLeftBtn);\n    const containerWidth = getDomWidth(container);\n\n    return Math.max(-(leftOperationsZoneWidth - leftIconWidth), scrollLeft - containerWidth);\n  },\n\n  /**\n   * 计算点击“往右按钮”时，需要的偏移值\n   * @param depElement 计算时依赖的元素\n   * @param scrollLeft 当前的偏移值\n   * @returns number\n   */\n  scrollToRight(depElement: allElementDeps, scrollLeft: number): number {\n    const {\n      navsContainer: container, navsWrap: wrap, rightOperations, toRightBtn\n    } = depElement;\n    const rightOperationsZoneWidth = getDomWidth(rightOperations);\n    const rightIconWidth = getDomWidth(toRightBtn);\n    const containerWidth = getDomWidth(container);\n    const wrapWidth = getDomWidth(wrap);\n\n    return Math.min(\n      scrollLeft + containerWidth,\n      wrapWidth - containerWidth + rightOperationsZoneWidth - rightIconWidth,\n    );\n  },\n};\n"],"names":["getDomWidth","dom","offsetWidth","calcScrollLeft","elements","scrollLeft","container","navsContainer","wrap","navsWrap","rightOperations","rightOperationsZoneWidth","containerWidth","wrapWidth","calculateCanToLeft","depElement","placement","includes","toLowerCase","leftOperations","toLeftBtn","leftOperationsZoneWidth","leftIconWidth","Math","round","calculateCanToRight","toRightBtn","rightIconWidth","moveActiveTabIntoView","activeTab","totalWidthBeforeActiveTab","offsetLeft","_getLeftCoverWidth","leftCoverWidth","isCurrentTabHiddenInLeftZone","activeTabWidth","_getRightCoverWidth","abs","rightCoverWidth","isHiddenInRightZone","scrollToLeft","max","scrollToRight","min"],"mappings":"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"}