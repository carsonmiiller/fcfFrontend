{"version":3,"file":"NotificationPlugin.js","sources":["../../src/notification/NotificationPlugin.ts"],"sourcesContent":["import { fetchListInstance, listMap } from './NotificationList';\nimport {\n  NotificationCloseAllMethod,\n  NotificationCloseMethod,\n  NotificationErrorMethod,\n  NotificationInfoMethod,\n  NotificationInfoOptions,\n  NotificationInstance,\n  NotificationOptions,\n  NotificationPlacementList,\n  NotificationSuccessMethod,\n  NotificationThemeList,\n  NotificationWarningMethod,\n} from './type';\n\n// 扩展接口声明的结构，用户使用时可得到 .info 的 ts 提示\nexport interface Notification {\n  (theme: NotificationThemeList, options: NotificationOptions): Promise<NotificationInstance>;\n  info: NotificationInfoMethod;\n  success: NotificationSuccessMethod;\n  warning: NotificationWarningMethod;\n  error: NotificationErrorMethod;\n  closeAll: NotificationCloseAllMethod;\n  close: NotificationCloseMethod;\n}\n\n/**\n * @desc 函数调用时的渲染函数\n * @param theme 主题类型\n * @param options 通知的参数\n */\nconst renderNotification = (theme: NotificationThemeList, options: NotificationInfoOptions) => {\n  if (typeof options !== 'object') return;\n\n  const placement: NotificationPlacementList = (() => {\n    if (['top-left', 'top-right', 'bottom-left', 'bottom-right'].indexOf(options.placement) >= 0) {\n      return options.placement;\n    }\n    return 'top-right';\n  })();\n\n  const attach: HTMLElement = (() => {\n    if (options.attach && typeof options.attach === 'string') {\n      const element: Element = document.querySelector(options.attach);\n      if (element instanceof HTMLElement) return element;\n    }\n\n    if (options.attach instanceof HTMLElement) return options.attach;\n\n    const containerId = `tdesign-notification-${placement}`;\n    const container = document.querySelector(`#${containerId}`);\n    if (container && container instanceof HTMLElement) {\n      return container;\n    }\n\n    const element: HTMLDivElement = document.createElement('div');\n    element.setAttribute('id', containerId);\n    document.body.appendChild(element);\n    return element;\n  })();\n\n  const zIndex = options.zIndex || 6000;\n\n  return fetchListInstance(placement, attach, zIndex).then((listInstance) => listInstance.push(theme, options));\n};\n\nexport const NotificationPlugin: Notification = (theme, props) => renderNotification(theme, props);\nNotificationPlugin.info = (options) => renderNotification('info', options);\nNotificationPlugin.success = (options) => renderNotification('success', options);\nNotificationPlugin.warning = (options) => renderNotification('warning', options);\nNotificationPlugin.error = (options) => renderNotification('error', options);\nNotificationPlugin.close = (promise) => promise.then((instance) => instance.close());\nNotificationPlugin.closeAll = () => listMap.forEach((list) => list.removeAll());\n"],"names":["renderNotification","theme","options","placement","indexOf","attach","element2","document","querySelector","HTMLElement","containerId","container","element","createElement","setAttribute","body","appendChild","zIndex","fetchListInstance","then","listInstance","push","NotificationPlugin","props","info","success","warning","error","close","promise","instance","closeAll","listMap","forEach","list","removeAll"],"mappings":"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"}