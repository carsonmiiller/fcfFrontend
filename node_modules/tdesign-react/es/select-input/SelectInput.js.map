{"version":3,"file":"SelectInput.js","sources":["../../src/select-input/SelectInput.tsx"],"sourcesContent":["import React, { forwardRef, useRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport useConfig from '../_util/useConfig';\nimport Popup from '../popup';\nimport useSingle from './useSingle';\nimport useMultiple from './useMultiple';\nimport useOverlayStyle from './useOverlayStyle';\nimport { TdSelectInputProps } from './type';\nimport { StyledProps } from '../common';\nimport { selectInputDefaultProps } from './defaultProps';\n\nexport interface SelectInputProps extends TdSelectInputProps, StyledProps {\n  updateScrollTop?: (content: HTMLDivElement) => void;\n}\n\nconst SelectInput = forwardRef((props: SelectInputProps, ref) => {\n  const selectInputRef = useRef();\n  const selectInputWrapRef = useRef();\n  const { classPrefix: prefix } = useConfig();\n  const { multiple, value, popupVisible, popupProps, borderless, disabled } = props;\n  const { tOverlayStyle, innerPopupVisible, onInnerPopupVisibleChange } = useOverlayStyle(props);\n  const { commonInputProps, inputRef, onInnerClear, renderSelectSingle } = useSingle(props);\n  const { tagInputRef, renderSelectMultiple } = useMultiple(props);\n\n  const popupClasses = classNames([\n    props.className,\n    `${prefix}-select-input`,\n    {\n      [`${prefix}-select-input--borderless`]: borderless,\n      [`${prefix}-select-input--multiple`]: multiple,\n      [`${prefix}-select-input--popup-visible`]: popupVisible ?? innerPopupVisible,\n      [`${prefix}-select-input--empty`]: value instanceof Array ? !value.length : !value,\n    },\n  ]);\n\n  useImperativeHandle(ref, () => ({\n    ...(selectInputRef.current || {}),\n    ...(inputRef.current || {}),\n    ...(tagInputRef.current || {}),\n  }));\n\n  // 浮层显示的受控与非受控\n  const visibleProps = { visible: popupVisible ?? innerPopupVisible };\n\n  const mainContent = (\n    <Popup\n      ref={selectInputRef}\n      style={props.style}\n      className={popupClasses}\n      trigger={popupProps?.trigger || 'click'}\n      placement=\"bottom-left\"\n      content={props.panel}\n      hideEmptyPopup={true}\n      onVisibleChange={onInnerPopupVisibleChange}\n      {...visibleProps}\n      {...popupProps}\n      disabled={disabled}\n      overlayStyle={tOverlayStyle}\n      updateScrollTop={props.updateScrollTop}\n    >\n      {multiple\n        ? renderSelectMultiple({\n            commonInputProps,\n            onInnerClear,\n            popupVisible: visibleProps.visible,\n          })\n        : renderSelectSingle(visibleProps.visible)}\n    </Popup>\n  );\n\n  if (!props.tips) return mainContent;\n\n  return (\n    <div ref={selectInputWrapRef} className={`${prefix}-select-input__wrap`}>\n      {mainContent}\n      <div className={`${prefix}-input__tips ${prefix}-input__tips--${props.status || 'normal'}`}>{props.tips}</div>\n    </div>\n  );\n});\n\nSelectInput.displayName = 'SelectInput';\nSelectInput.defaultProps = selectInputDefaultProps;\n\nexport default SelectInput;\n"],"names":["SelectInput","forwardRef","props","ref","selectInputRef","useRef","selectInputWrapRef","useConfig","prefix","classPrefix","multiple","value","popupVisible","popupProps","borderless","disabled","useOverlayStyle","tOverlayStyle","innerPopupVisible","onInnerPopupVisibleChange","useSingle","commonInputProps","inputRef","onInnerClear","renderSelectSingle","useMultiple","tagInputRef","renderSelectMultiple","popupClasses","classNames","className","Array","length","useImperativeHandle","current","visibleProps","visible","mainContent","React","createElement","Popup","style","trigger","placement","content","panel","hideEmptyPopup","onVisibleChange","overlayStyle","updateScrollTop","tips","status","displayName","defaultProps","selectInputDefaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQMA,IAAAA,WAAW,gBAAGC,UAAU,CAAC,UAACC,KAAD,EAAQC,GAAR,EAAgB;AAAA,EAAA,IAAA,IAAA,CAAA;;EAC7C,IAAMC,cAAc,GAAGC,MAAM,EAA7B,CAAA;EACA,IAAMC,kBAAkB,GAAGD,MAAM,EAAjC,CAAA;;AACA,EAAA,IAAA,UAAA,GAAgCE,SAAS,EAAzC;MAAqBC,MAArB,cAAQC,WAAR,CAAA;;AACA,EAAA,IAAQC,QAAR,GAA4ER,KAA5E,CAAQQ,QAAR;AAAA,MAAkBC,KAAlB,GAA4ET,KAA5E,CAAkBS,KAAlB;AAAA,MAAyBC,YAAzB,GAA4EV,KAA5E,CAAyBU,YAAzB;AAAA,MAAuCC,UAAvC,GAA4EX,KAA5E,CAAuCW,UAAvC;AAAA,MAAmDC,UAAnD,GAA4EZ,KAA5E,CAAmDY,UAAnD;AAAA,MAA+DC,QAA/D,GAA4Eb,KAA5E,CAA+Da,QAA/D,CAAA;;EACA,IAAwEC,gBAAAA,GAAAA,eAAe,CAACd,KAAD,CAAvF;MAAQe,aAAR,oBAAQA,aAAR;MAAuBC,iBAAvB,oBAAuBA,iBAAvB;MAA0CC,yBAA1C,oBAA0CA,yBAA1C,CAAA;;EACA,IAAyEC,UAAAA,GAAAA,SAAS,CAAClB,KAAD,CAAlF;MAAQmB,gBAAR,cAAQA,gBAAR;MAA0BC,QAA1B,cAA0BA,QAA1B;MAAoCC,YAApC,cAAoCA,YAApC;MAAkDC,kBAAlD,cAAkDA,kBAAlD,CAAA;;EACA,IAA8CC,YAAAA,GAAAA,WAAW,CAACvB,KAAD,CAAzD;MAAQwB,WAAR,gBAAQA,WAAR;MAAqBC,oBAArB,gBAAqBA,oBAArB,CAAA;;AACA,EAAA,IAAMC,YAAY,GAAGC,UAAU,CAAC,CAC9B3B,KAAK,CAAC4B,SADwB,EAAA,EAAA,CAAA,MAAA,CAE3BtB,MAF2B,EAIxBA,eAAAA,CAAAA,GAAAA,IAAAA,GAAAA,EAAAA,EAAAA,eAAAA,CAAAA,IAAAA,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,MAJwB,gCAIYM,UAJZ,CAAA,EAAA,eAAA,CAAA,IAAA,EAAA,EAAA,CAAA,MAAA,CAKxBN,MALwB,EAKUE,yBAAAA,CAAAA,EAAAA,QALV,mCAMxBF,MANwB,EAAA,8BAAA,CAAA,EAMeI,YANf,KAMeA,IAAAA,IAAAA,YANf,cAMeA,YANf,GAM+BM,iBAN/B,CAOxBV,EAAAA,eAAAA,CAAAA,IAAAA,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,MAPwB,2BAOOG,KAAK,YAAYoB,KAAjB,GAAyB,CAACpB,KAAK,CAACqB,MAAhC,GAAyC,CAACrB,KAPjD,SAAD,CAA/B,CAAA;EAUAsB,mBAAmB,CAAC9B,GAAD,EAAM,YAAA;AAAA,IAAA,OAAA,aAAA,CAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EACpBC,cAAc,CAAC8B,OAAf,IAA0B,EADN,GAEpBZ,QAAQ,CAACY,OAAT,IAAoB,EAFA,CAGpBR,EAAAA,WAAW,CAACQ,OAAZ,IAAuB,EAHH,CAAA,CAAA;AAAA,GAAN,CAAnB,CAAA;AAKA,EAAA,IAAMC,YAAY,GAAG;AAAEC,IAAAA,OAAO,EAAExB,YAAF,KAAA,IAAA,IAAEA,YAAF,KAAA,KAAA,CAAA,GAAEA,YAAF,GAAkBM,iBAAAA;GAAhD,CAAA;AACA,EAAA,IAAMmB,WAAW,kBAAmBC,KAAK,CAACC,aAAN,CAAoBC,KAApB,EAAA,aAAA,CAAA,aAAA,CAAA,aAAA,CAAA;AAClCrC,IAAAA,GAAG,EAAEC,cAD6B;IAElCqC,KAAK,EAAEvC,KAAK,CAACuC,KAFqB;AAGlCX,IAAAA,SAAS,EAAEF,YAHuB;AAIlCc,IAAAA,OAAO,EAAE,CAAA7B,UAAU,KAAA,IAAV,IAAAA,UAAU,KAAV,KAAA,CAAA,GAAA,KAAA,CAAA,GAAAA,UAAU,CAAE6B,OAAZ,KAAuB,OAJE;AAKlCC,IAAAA,SAAS,EAAE,aALuB;IAMlCC,OAAO,EAAE1C,KAAK,CAAC2C,KANmB;AAOlCC,IAAAA,cAAc,EAAE,IAPkB;AAQlCC,IAAAA,eAAe,EAAE5B,yBAAAA;GACdgB,EAAAA,YAT+B,GAU/BtB,UAV+B,CAAA,EAAA,EAAA,EAAA;AAWlCE,IAAAA,QAAQ,EAARA,QAXkC;AAYlCiC,IAAAA,YAAY,EAAE/B,aAZoB;IAalCgC,eAAe,EAAE/C,KAAK,CAAC+C,eAAAA;GACtBvC,CAAAA,EAAAA,QAAQ,GAAGiB,oBAAoB,CAAC;AACjCN,IAAAA,gBAAgB,EAAhBA,gBADiC;AAEjCE,IAAAA,YAAY,EAAZA,YAFiC;IAGjCX,YAAY,EAAEuB,YAAY,CAACC,OAAAA;GAHK,CAAvB,GAINZ,kBAAkB,CAACW,YAAY,CAACC,OAAd,CAlBa,CAApC,CAAA;AAmBA,EAAA,IAAI,CAAClC,KAAK,CAACgD,IAAX,EACE,OAAOb,WAAP,CAAA;AACF,EAAA,sBAAuBC,KAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;AAChDpC,IAAAA,GAAG,EAAEG,kBAD2C;AAEhDwB,IAAAA,SAAS,YAAKtB,MAAL,EAAA,qBAAA,CAAA;GAFY,EAGpB6B,WAHoB,iBAGSC,KAAK,CAACC,aAAN,CAAoB,KAApB,EAA2B;IACzDT,SAAS,EAAA,EAAA,CAAA,MAAA,CAAKtB,MAAL,EAA2BA,eAAAA,CAAAA,CAAAA,MAAAA,CAAAA,MAA3B,2BAAkDN,KAAK,CAACiD,MAAN,IAAgB,QAAlE,CAAA;AADgD,GAA3B,EAE7BjD,KAAK,CAACgD,IAFuB,CAHT,CAAvB,CAAA;AAMD,CAnD6B,EAA9B;AAoDAlD,WAAW,CAACoD,WAAZ,GAA0B,aAA1B,CAAA;AACApD,WAAW,CAACqD,YAAZ,GAA2BC,uBAA3B;;;;"}