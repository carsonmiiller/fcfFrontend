{"version":3,"file":"useRange.js","sources":["../../../src/date-picker/hooks/useRange.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { CalendarIcon } from 'tdesign-icons-react';\nimport dayjs from 'dayjs';\nimport classNames from 'classnames';\nimport useConfig from '../../_util/useConfig';\nimport useControlled from '../../hooks/useControlled';\nimport { RangeInputRefInterface } from '../../range-input';\nimport { TdDateRangePickerProps, DateValue } from '../type';\nimport useFormat from './useFormat';\n\nexport const PARTIAL_MAP = { first: 'start', second: 'end' };\n\n// 初始化面板年份月份\nfunction initYearMonthTime(value: DateValue[], mode = 'date', format: string, timeFormat = 'HH:mm:ss') {\n  const defaultYearMonthTime = {\n    year: [dayjs().year(), dayjs().year()],\n    month: [dayjs().month(), dayjs().month()],\n    time: [dayjs().format(timeFormat), dayjs().format(timeFormat)],\n  };\n  if (mode === 'year') {\n    defaultYearMonthTime.year[1] += 10;\n  } else if (mode === 'month') {\n    defaultYearMonthTime.year[1] += 1;\n  } else if (mode === 'date') {\n    defaultYearMonthTime.month[1] += 1;\n  }\n\n  if (!value || !Array.isArray(value) || !value.length) {\n    return defaultYearMonthTime;\n  }\n\n  return {\n    year: value.map((v) => dayjs(v, format).year()),\n    month: value.map((v) => dayjs(v, format).month()),\n    time: value.map((v) => dayjs(v, format).format(timeFormat)),\n  };\n}\n\nexport default function useRange(props: TdDateRangePickerProps) {\n  const { classPrefix, datePicker: globalDatePickerConfig } = useConfig();\n  const name = `${classPrefix}-date-range-picker`;\n\n  const isMountedRef = useRef(false);\n  const inputRef = useRef<RangeInputRefInterface>();\n\n  const {\n    mode,\n    prefixIcon,\n    suffixIcon,\n    rangeInputProps: rangeInputPropsFromProps,\n    popupProps: popupPropsFromProps,\n    allowInput,\n    clearable,\n    placeholder = globalDatePickerConfig.placeholder[mode],\n    onBlur,\n    onFocus,\n    onInput,\n  } = props;\n\n  const [value, onChange] = useControlled(props, 'value', props.onChange);\n  const { format, isValidDate, timeFormat, formatDate, formatTime } = useFormat({\n    mode,\n    value,\n    format: props.format,\n    valueType: props.valueType,\n    enableTimePicker: props.enableTimePicker,\n  });\n\n  // warning invalid value\n  if (!Array.isArray(value)) {\n    console.error(`typeof value: ${value} must be Array!`);\n  } else if (!isValidDate(value, 'valueType')) {\n    console.error(`value: ${value} is invalid datetime!`);\n  }\n\n  const [popupVisible, setPopupVisible] = useState(false);\n  const [isHoverCell, setIsHoverCell] = useState(false);\n  const [activeIndex, setActiveIndex] = useState(0); // 确定当前选中的输入框序号\n  const [isFirstValueSelected, setIsFirstValueSelected] = useState(false); // 记录面板点击次数，两次后才自动关闭\n  const [timeValue, setTimeValue] = useState(initYearMonthTime(value, mode, format, timeFormat).time);\n  const [month, setMonth] = useState<Array<number>>(initYearMonthTime(value, mode, format).month);\n  const [year, setYear] = useState<Array<number>>(initYearMonthTime(value, mode, format).year);\n  // 未真正选中前可能不断变更输入框的内容\n  const [inputValue, setInputValue] = useState(formatDate(value));\n  // 选择阶段预选状态\n  const [cacheValue, setCacheValue] = useState(formatDate(value));\n\n  // input 设置\n  const rangeInputProps = {\n    ...rangeInputPropsFromProps,\n    ref: inputRef,\n    clearable,\n    prefixIcon,\n    readonly: !allowInput,\n    placeholder,\n    activeIndex: popupVisible ? activeIndex : undefined,\n    suffixIcon: suffixIcon || <CalendarIcon />,\n    className: classNames({\n      [`${name}__input--placeholder`]: isHoverCell,\n    }),\n    onClick: ({ position }) => {\n      setActiveIndex(position === 'first' ? 0 : 1);\n    },\n    onClear: ({ e }) => {\n      e.stopPropagation();\n      setPopupVisible(false);\n      onChange([], { dayjsValue: [], trigger: 'clear' });\n    },\n    onBlur: (newVal: string[], { e, position }) => {\n      onBlur?.({ value: newVal, partial: PARTIAL_MAP[position], e });\n    },\n    onFocus: (newVal: string[], { e, position }) => {\n      onFocus?.({ value: newVal, partial: PARTIAL_MAP[position], e });\n      setActiveIndex(position === 'first' ? 0 : 1);\n    },\n    onChange: (newVal: string[], { e, position }) => {\n      const index = position === 'first' ? 0 : 1;\n\n      onInput?.({ input: newVal[index], value, partial: PARTIAL_MAP[position], e });\n      setInputValue(newVal);\n\n      // 跳过不符合格式化的输入框内容\n      if (!isValidDate(newVal)) return;\n      const newYear = [];\n      const newMonth = [];\n      const newTime = [];\n      newVal.forEach((v, i) => {\n        newYear.push(dayjs(v).year() || year[i]);\n        newMonth.push(dayjs(v).month() || month[i]);\n        newTime.push(dayjs(v).format(timeFormat) || timeValue[i]);\n      });\n      setYear(newYear);\n      setMonth(newMonth);\n      setTimeValue(newTime);\n    },\n    onEnter: (newVal: string[]) => {\n      if (!isValidDate(newVal) && !isValidDate(value)) return;\n\n      setPopupVisible(false);\n      if (isValidDate(newVal)) {\n        onChange(formatDate(newVal, 'valueType') as DateValue[], {\n          dayjsValue: newVal.map((v) => dayjs(v)),\n          trigger: 'enter',\n        });\n      } else if (isValidDate(value)) {\n        setInputValue(formatDate(value));\n      } else {\n        setInputValue([]);\n      }\n    },\n  };\n\n  // popup 设置\n  const popupProps = {\n    expandAnimation: true,\n    ...popupPropsFromProps,\n    overlayStyle: popupPropsFromProps?.overlayStyle ?? { width: 'auto' },\n    overlayClassName: classNames(popupPropsFromProps?.overlayClassName, `${name}__panel-container`),\n    onVisibleChange: (visible: boolean, context) => {\n      // 输入框点击不关闭面板\n      if (context.trigger === 'trigger-element-click') {\n        const indexMap = { 0: 'first', 1: 'second' };\n        inputRef.current.focus({ position: indexMap[activeIndex] });\n        return setPopupVisible(true);\n      }\n      if (visible) {\n        // 展开后重置点击次数\n        setIsFirstValueSelected(false);\n      } else {\n        setIsHoverCell(false);\n        setInputValue(formatDate(value));\n      }\n\n      setPopupVisible(visible);\n    },\n  };\n\n  // 输入框响应 value 变化\n  useEffect(() => {\n    if (!value) {\n      setInputValue([]);\n      setCacheValue([]);\n      setTimeValue([dayjs().format(timeFormat), dayjs().format(timeFormat)]);\n      return;\n    }\n    if (!isValidDate(value, 'valueType')) return;\n\n    setInputValue(formatDate(value));\n    setCacheValue(formatDate(value));\n    setTimeValue(formatTime(value));\n    // eslint-disable-next-line\n  }, [value]);\n\n  // activeIndex 变化自动 focus 对应输入框\n  useEffect(() => {\n    if (!isMountedRef.current) {\n      isMountedRef.current = true;\n      return;\n    }\n    const indexMap = { 0: 'first', 1: 'second' };\n    inputRef.current.focus({ position: indexMap[activeIndex] });\n    // eslint-disable-next-line\n  }, [activeIndex]);\n\n  return {\n    year,\n    month,\n    value,\n    timeValue,\n    inputValue,\n    popupVisible,\n    rangeInputProps,\n    popupProps,\n    isHoverCell,\n    onChange,\n    setYear,\n    setMonth,\n    setTimeValue,\n    setIsHoverCell,\n    setInputValue,\n    setPopupVisible,\n    activeIndex,\n    setActiveIndex,\n    isFirstValueSelected,\n    setIsFirstValueSelected,\n    cacheValue,\n    setCacheValue,\n  };\n}\n"],"names":["PARTIAL_MAP","first","second","initYearMonthTime","value","mode","format","timeFormat","defaultYearMonthTime","year","dayjs","month","time","Array","isArray","length","map","v","useRange","props","useConfig","classPrefix","globalDatePickerConfig","datePicker","name","isMountedRef","useRef","inputRef","prefixIcon","suffixIcon","rangeInputPropsFromProps","rangeInputProps","popupPropsFromProps","popupProps","allowInput","clearable","placeholder","onBlur","onFocus","onInput","useControlled","onChange","useFormat","valueType","enableTimePicker","isValidDate","formatDate","formatTime","console","error","useState","popupVisible","setPopupVisible","isHoverCell","setIsHoverCell","activeIndex","setActiveIndex","isFirstValueSelected","setIsFirstValueSelected","timeValue","setTimeValue","setMonth","setYear","inputValue","setInputValue","cacheValue","setCacheValue","ref","readonly","React","createElement","CalendarIcon","className","classNames","onClick","position","onClear","e","stopPropagation","dayjsValue","trigger","newVal","partial","index","input","newYear","newMonth","newTime","forEach","i","push","onEnter","expandAnimation","overlayStyle","width","overlayClassName","onVisibleChange","visible","context","indexMap","current","focus","useEffect"],"mappings":"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"}