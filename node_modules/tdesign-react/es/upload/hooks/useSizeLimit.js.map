{"version":3,"file":"useSizeLimit.js","sources":["../../../src/upload/hooks/useSizeLimit.ts"],"sourcesContent":["import type { SizeLimitObj, SizeUnit, SizeUnitArray } from '../type';\nimport { useLocaleReceiver } from '../../locale/LocalReceiver';\n\n// 各个单位和 B 的关系\nconst SIZE_MAP = {\n  B: 1,\n  KB: 1024,\n  MB: 1048576, // 1024 * 1024\n  GB: 1073741824, // 1024 * 1024 * 1024\n};\n\n/**\n * 大小比较\n * @param fileSize 以B为单位\n * @param sizeLimit\n * @param unit 计算机计量单位\n */\nfunction judgeIsSuitableSize(fileSize: number, sizeLimit: number, unit: SizeUnit) {\n  // 以 KB 为单位进行比较\n  const units: SizeUnitArray = ['B', 'KB', 'MB', 'GB'];\n  const index = units.indexOf(unit);\n  if (index === -1) {\n    console.warn(`TDesign Upload Warn: \\`sizeLimit.unit\\` can only be one of ${units.join()}`);\n  }\n  return fileSize <= sizeLimit * SIZE_MAP[unit];\n}\n\nexport default function useHandleLimit() {\n  const [local, t] = useLocaleReceiver('upload');\n  return handleSizeLimit;\n\n  // eslint-disable-next-line\n  function handleSizeLimit(fileSize: number = 0, rawSizeLimit: SizeLimitObj | number) {\n    const sizeLimit: SizeLimitObj =\n      typeof rawSizeLimit === 'number' ? { size: rawSizeLimit, unit: 'KB' } : rawSizeLimit;\n    sizeLimit.unit = sizeLimit.unit.toUpperCase() as SizeUnit;\n    const isSuitableSize = judgeIsSuitableSize(fileSize, sizeLimit.size, sizeLimit.unit);\n    let errorMsg;\n    if (!isSuitableSize) {\n      errorMsg = sizeLimit.message\n        ? t(sizeLimit.message, { sizeLimit: sizeLimit.size })\n        : `${t(local.sizeLimitMessage, { sizeLimit: sizeLimit.size })} ${sizeLimit.unit}`;\n    }\n    return [isSuitableSize, errorMsg];\n  }\n}\n"],"names":["SIZE_MAP","B","KB","MB","GB","judgeIsSuitableSize","fileSize","sizeLimit","unit","units","index","indexOf","console","warn","join","useHandleLimit","useLocaleReceiver","local","t","handleSizeLimit","rawSizeLimit","size","toUpperCase","isSuitableSize","errorMsg","message","sizeLimitMessage"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,IAAMA,QAAQ,GAAG;AACfC,EAAAA,CAAC,EAAE,CADY;AAEfC,EAAAA,EAAE,EAAE,IAFW;AAGfC,EAAAA,EAAE,EAAE,OAHW;AAIfC,EAAAA,EAAE,EAAE,UAAA;AAJW,CAAjB,CAAA;;AAMA,SAASC,mBAAT,CAA6BC,QAA7B,EAAuCC,SAAvC,EAAkDC,IAAlD,EAAwD;EACtD,IAAMC,KAAK,GAAG,CAAC,GAAD,EAAM,IAAN,EAAY,IAAZ,EAAkB,IAAlB,CAAd,CAAA;AACA,EAAA,IAAMC,KAAK,GAAGD,KAAK,CAACE,OAAN,CAAcH,IAAd,CAAd,CAAA;;AACA,EAAA,IAAIE,KAAK,KAAK,CAAC,CAAf,EAAkB;AAChBE,IAAAA,OAAO,CAACC,IAAR,CAAA,2DAAA,CAAA,MAAA,CAA2EJ,KAAK,CAACK,IAAN,EAA3E,CAAA,CAAA,CAAA;AACD,GAAA;;AACD,EAAA,OAAOR,QAAQ,IAAIC,SAAS,GAAGP,QAAQ,CAACQ,IAAD,CAAvC,CAAA;AACD,CAAA;;AACc,SAASO,cAAT,GAA0B;EACvC,IAAmBC,kBAAAA,GAAAA,iBAAiB,CAAC,QAAD,CAApC;AAAA,MAAA,mBAAA,GAAA,cAAA,CAAA,kBAAA,EAAA,CAAA,CAAA;AAAA,MAAOC,KAAP,GAAA,mBAAA,CAAA,CAAA,CAAA;AAAA,MAAcC,CAAd,GAAA,mBAAA,CAAA,CAAA,CAAA,CAAA;;AACA,EAAA,OAAOC,eAAP,CAAA;;AACA,EAAA,SAASA,eAAT,GAAqD;IAAA,IAA5Bb,QAA4B,uEAAjB,CAAiB,CAAA;AAAA,IAAA,IAAdc,YAAc,GAAA,SAAA,CAAA,MAAA,GAAA,CAAA,GAAA,SAAA,CAAA,CAAA,CAAA,GAAA,SAAA,CAAA;AACnD,IAAA,IAAMb,SAAS,GAAG,OAAOa,YAAP,KAAwB,QAAxB,GAAmC;AAAEC,MAAAA,IAAI,EAAED,YAAR;AAAsBZ,MAAAA,IAAI,EAAE,IAAA;AAA5B,KAAnC,GAAwEY,YAA1F,CAAA;IACAb,SAAS,CAACC,IAAV,GAAiBD,SAAS,CAACC,IAAV,CAAec,WAAf,EAAjB,CAAA;AACA,IAAA,IAAMC,cAAc,GAAGlB,mBAAmB,CAACC,QAAD,EAAWC,SAAS,CAACc,IAArB,EAA2Bd,SAAS,CAACC,IAArC,CAA1C,CAAA;AACA,IAAA,IAAIgB,QAAJ,CAAA;;IACA,IAAI,CAACD,cAAL,EAAqB;MACnBC,QAAQ,GAAGjB,SAAS,CAACkB,OAAV,GAAoBP,CAAC,CAACX,SAAS,CAACkB,OAAX,EAAoB;QAAElB,SAAS,EAAEA,SAAS,CAACc,IAAAA;AAAvB,OAApB,CAArB,GAA6EH,EAAAA,CAAAA,MAAAA,CAAAA,CAAC,CAACD,KAAK,CAACS,gBAAP,EAAyB;QAAEnB,SAAS,EAAEA,SAAS,CAACc,IAAAA;AAAvB,OAAzB,CAA9E,EAAA,GAAA,CAAA,CAAA,MAAA,CAAyId,SAAS,CAACC,IAAnJ,CAAX,CAAA;AACD,KAAA;;AACD,IAAA,OAAO,CAACe,cAAD,EAAiBC,QAAjB,CAAP,CAAA;AACD,GAAA;AACF;;;;"}