{"version":3,"file":"Switch.js","sources":["../../src/switch/Switch.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useState } from 'react';\nimport classNames from 'classnames';\nimport Loading from '../loading';\nimport useConfig from '../_util/useConfig';\nimport { StyledProps } from '../common';\nimport useCommonClassName from '../_util/useCommonClassName';\nimport { TdSwitchProps } from './type';\nimport { switchDefaultProps } from './defaultProps';\n\nexport type SwitchChangeEventHandler = (value: boolean, event: React.MouseEvent<HTMLButtonElement>) => void;\nexport type SwitchClickEventHandler = SwitchChangeEventHandler;\n\nexport interface SwitchProps extends TdSwitchProps, StyledProps {}\n\nconst Switch = forwardRef((props: SwitchProps, ref: React.Ref<HTMLButtonElement>) => {\n  const { classPrefix } = useConfig();\n  const { className, value, defaultValue, disabled, loading, size, label, customValue, onChange, ...restProps } = props;\n  const [activeValue = true, inactiveValue = false] = customValue || [];\n\n  const isControlled = typeof value !== 'undefined';\n  const initChecked = defaultValue === activeValue || value === activeValue;\n  const [innerChecked, setInnerChecked] = useState(initChecked);\n\n  function renderContent(checked: boolean) {\n    if (typeof label === 'function') return label({ value });\n\n    if (typeof label === 'string') return label;\n\n    if (Array.isArray(label)) {\n      const [activeContent = '', inactiveContent = ''] = label;\n      const content = checked ? activeContent : inactiveContent;\n\n      if (typeof content === 'function') return content();\n\n      return content;\n    }\n\n    return null;\n  }\n\n  function onInternalClick() {\n    if (disabled) return;\n\n    !isControlled && setInnerChecked(!innerChecked);\n\n    const changedValue = !innerChecked ? activeValue : inactiveValue;\n    onChange?.(changedValue);\n  }\n\n  useEffect(() => {\n    if (Array.isArray(customValue) && !customValue.includes(value)) {\n      throw `value is not in customValue: ${JSON.stringify(customValue)}`;\n    }\n    isControlled && setInnerChecked(value === activeValue);\n  }, [value, customValue, activeValue, isControlled]);\n\n  const { SIZE, STATUS } = useCommonClassName();\n  const switchClassName = classNames(\n    `${classPrefix}-switch`,\n    className,\n    {\n      [STATUS.checked]: innerChecked,\n      [STATUS.disabled]: disabled,\n      [STATUS.loading]: loading,\n    },\n    SIZE[size],\n  );\n\n  return (\n    <button\n      {...restProps}\n      type=\"button\"\n      role=\"switch\"\n      disabled={disabled || loading}\n      className={switchClassName}\n      ref={ref}\n      onClick={onInternalClick}\n    >\n      <span className={`${classPrefix}-switch__handle`}>{loading && <Loading loading={true} size=\"small\" />}</span>\n      <div className={`${classPrefix}-switch__content`}>{renderContent(innerChecked)}</div>\n    </button>\n  );\n});\n\nSwitch.displayName = 'Switch';\nSwitch.defaultProps = switchDefaultProps;\n\nexport default Switch;\n"],"names":["Switch","forwardRef","props","ref","useConfig","classPrefix","className","value","defaultValue","disabled","loading","size","label","customValue","onChange","restProps","activeValue","inactiveValue","isControlled","initChecked","useState","innerChecked","setInnerChecked","renderContent","checked","Array","isArray","activeContent","inactiveContent","content","onInternalClick","changedValue","useEffect","includes","JSON","stringify","useCommonClassName","SIZE","STATUS","switchClassName","classNames","React","createElement","type","role","onClick","Loading","displayName","defaultProps","switchDefaultProps"],"mappings":"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"}