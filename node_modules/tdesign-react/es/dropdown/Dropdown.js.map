{"version":3,"file":"Dropdown.js","sources":["../../src/dropdown/Dropdown.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport classNames from 'classnames';\nimport omit from 'lodash/omit';\nimport { DropdownOption, TdDropdownProps } from './type';\nimport { ClassName } from '../common';\nimport useConfig from '../_util/useConfig';\nimport Popup, { PopupVisibleChangeContext } from '../popup';\nimport DropdownMenu from './DropdownMenu';\nimport DropdownItem from './DropdownItem';\nimport { dropdownDefaultProps } from './defaultProps';\n\nexport interface DropdownProps extends TdDropdownProps {\n  className?: ClassName;\n  children?: React.ReactNode;\n}\n\nconst Dropdown = (props: DropdownProps) => {\n  const { popupProps = {}, disabled, placement, trigger, className, children, hideAfterItemClick } = props;\n  let content = null;\n  const arrayChildren = React.Children.toArray(children);\n\n  const { classPrefix } = useConfig();\n  const [isPopupVisible, togglePopupVisible] = useState(false);\n  const dropdownClass = `${classPrefix}-dropdown`;\n\n  const handleMenuClick = (data: DropdownOption, context: { e: React.MouseEvent<HTMLDivElement, MouseEvent> }) => {\n    if (hideAfterItemClick) {\n      togglePopupVisible(false);\n    }\n    props?.onClick?.(data, context);\n  };\n\n  const DropdownContent = () => <DropdownMenu {...props} onClick={handleMenuClick}></DropdownMenu>;\n\n  const handleVisibleChange = (visible: boolean, context: PopupVisibleChangeContext) => {\n    togglePopupVisible(visible);\n    popupProps?.onVisibleChange?.(visible, context);\n  };\n\n  React.Children.forEach(arrayChildren, (child: React.ReactChild, idx) => {\n    if (typeof child !== 'object') return;\n\n    if (child.type === DropdownMenu) {\n      content = React.cloneElement(child, { onClick: handleMenuClick });\n      arrayChildren.splice(idx, 1);\n    }\n  });\n\n  const popupParams = {\n    disabled,\n    placement,\n    trigger,\n    showArrow: false,\n    overlayClassName: classNames(dropdownClass, className),\n    content: content || DropdownContent(),\n    ...omit(popupProps, 'onVisibleChange'),\n  };\n\n  return (\n    <Popup\n      expandAnimation={true}\n      destroyOnClose={true}\n      visible={isPopupVisible}\n      onVisibleChange={handleVisibleChange}\n      {...popupParams}\n    >\n      {arrayChildren}\n    </Popup>\n  );\n};\n\nDropdown.DropdownMenu = DropdownMenu;\nDropdown.DropdownItem = DropdownItem;\n\nDropdown.displayName = 'Dropdown';\nDropdown.defaultProps = dropdownDefaultProps;\n\nexport default Dropdown;\n"],"names":["Dropdown","props","popupProps","disabled","placement","trigger","className","children","hideAfterItemClick","content","arrayChildren","React","Children","toArray","useConfig","classPrefix","useState","isPopupVisible","togglePopupVisible","dropdownClass","handleMenuClick","data","context","onClick","DropdownContent","createElement","DropdownMenu","handleVisibleChange","visible","onVisibleChange","forEach","child","idx","type","cloneElement","splice","popupParams","showArrow","overlayClassName","classNames","omit","Popup","expandAnimation","destroyOnClose","DropdownItem","displayName","defaultProps","dropdownDefaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,IAAMA,QAAQ,GAAG,SAAXA,QAAW,CAACC,KAAD,EAAW;EAC1B,IAAmGA,iBAAAA,GAAAA,KAAnG,CAAQC,UAAR;MAAQA,UAAR,kCAAqB,EAArB,GAAA,iBAAA;AAAA,MAAyBC,QAAzB,GAAmGF,KAAnG,CAAyBE,QAAzB;AAAA,MAAmCC,SAAnC,GAAmGH,KAAnG,CAAmCG,SAAnC;AAAA,MAA8CC,OAA9C,GAAmGJ,KAAnG,CAA8CI,OAA9C;AAAA,MAAuDC,SAAvD,GAAmGL,KAAnG,CAAuDK,SAAvD;AAAA,MAAkEC,QAAlE,GAAmGN,KAAnG,CAAkEM,QAAlE;AAAA,MAA4EC,kBAA5E,GAAmGP,KAAnG,CAA4EO,kBAA5E,CAAA;EACA,IAAIC,OAAO,GAAG,IAAd,CAAA;EACA,IAAMC,aAAa,GAAGC,KAAK,CAACC,QAAN,CAAeC,OAAf,CAAuBN,QAAvB,CAAtB,CAAA;;AACA,EAAA,IAAA,UAAA,GAAwBO,SAAS,EAAjC;MAAQC,WAAR,cAAQA,WAAR,CAAA;;EACA,IAA6CC,SAAAA,GAAAA,QAAQ,CAAC,KAAD,CAArD;AAAA,MAAA,UAAA,GAAA,cAAA,CAAA,SAAA,EAAA,CAAA,CAAA;AAAA,MAAOC,cAAP,GAAA,UAAA,CAAA,CAAA,CAAA;AAAA,MAAuBC,kBAAvB,GAAA,UAAA,CAAA,CAAA,CAAA,CAAA;;EACA,IAAMC,aAAa,GAAMJ,EAAAA,CAAAA,MAAAA,CAAAA,WAAN,EAAnB,WAAA,CAAA,CAAA;;EACA,IAAMK,eAAe,GAAG,SAAlBA,eAAkB,CAACC,IAAD,EAAOC,OAAP,EAAmB;AAAA,IAAA,IAAA,cAAA,CAAA;;AACzC,IAAA,IAAId,kBAAJ,EAAwB;MACtBU,kBAAkB,CAAC,KAAD,CAAlB,CAAA;AACD,KAAA;;AACDjB,IAAAA,KAAK,KAAL,IAAA,IAAAA,KAAK,KAAA,KAAA,CAAL,8BAAAA,KAAK,CAAEsB,OAAP,MAAA,IAAA,IAAA,cAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,cAAA,CAAA,IAAA,CAAAtB,KAAK,EAAYoB,IAAZ,EAAkBC,OAAlB,CAAL,CAAA;GAJF,CAAA;;EAMA,IAAME,eAAe,GAAG,SAAlBA,eAAkB,GAAA;AAAA,IAAA,sBAAsBb,KAAK,CAACc,aAAN,CAAoBC,YAApB,kCACzCzB,KADyC,CAAA,EAAA,EAAA,EAAA;AAE5CsB,MAAAA,OAAO,EAAEH,eAAAA;KAFa,CAAA,CAAA,CAAA;GAAxB,CAAA;;EAIA,IAAMO,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,OAAD,EAAUN,OAAV,EAAsB;AAAA,IAAA,IAAA,qBAAA,CAAA;;IAChDJ,kBAAkB,CAACU,OAAD,CAAlB,CAAA;AACA1B,IAAAA,UAAU,KAAV,IAAA,IAAAA,UAAU,KAAA,KAAA,CAAV,qCAAAA,UAAU,CAAE2B,eAAZ,MAAA,IAAA,IAAA,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,qBAAA,CAAA,IAAA,CAAA3B,UAAU,EAAoB0B,OAApB,EAA6BN,OAA7B,CAAV,CAAA;GAFF,CAAA;;EAIAX,KAAK,CAACC,QAAN,CAAekB,OAAf,CAAuBpB,aAAvB,EAAsC,UAACqB,KAAD,EAAQC,GAAR,EAAgB;AACpD,IAAA,IAAI,OAAOD,CAAAA,KAAP,CAAiB,KAAA,QAArB,EACE,OAAA;;AACF,IAAA,IAAIA,KAAK,CAACE,IAAN,KAAeP,YAAnB,EAAiC;AAC/BjB,MAAAA,OAAO,gBAAGE,KAAK,CAACuB,YAAN,CAAmBH,KAAnB,EAA0B;AAAER,QAAAA,OAAO,EAAEH,eAAAA;AAAX,OAA1B,CAAV,CAAA;AACAV,MAAAA,aAAa,CAACyB,MAAd,CAAqBH,GAArB,EAA0B,CAA1B,CAAA,CAAA;AACD,KAAA;GANH,CAAA,CAAA;;AAQA,EAAA,IAAMI,WAAW,GAAA,aAAA,CAAA;AACfjC,IAAAA,QAAQ,EAARA,QADe;AAEfC,IAAAA,SAAS,EAATA,SAFe;AAGfC,IAAAA,OAAO,EAAPA,OAHe;AAIfgC,IAAAA,SAAS,EAAE,KAJI;AAKfC,IAAAA,gBAAgB,EAAEC,UAAU,CAACpB,aAAD,EAAgBb,SAAhB,CALb;IAMfG,OAAO,EAAEA,OAAO,IAAIe,eAAe,EAAA;AANpB,GAAA,EAOZgB,MAAI,CAACtC,UAAD,EAAa,iBAAb,CAPQ,CAAjB,CAAA;;AASA,EAAA,sBAAuBS,KAAK,CAACc,aAAN,CAAoBgB,KAApB,EAAA,aAAA,CAAA;AACrBC,IAAAA,eAAe,EAAE,IADI;AAErBC,IAAAA,cAAc,EAAE,IAFK;AAGrBf,IAAAA,OAAO,EAAEX,cAHY;AAIrBY,IAAAA,eAAe,EAAEF,mBAAAA;GACdS,EAAAA,WALkB,CAMpB1B,EAAAA,aANoB,CAAvB,CAAA;AAOD,EA7CD;;AA8CAV,QAAQ,CAAC0B,YAAT,GAAwBA,YAAxB,CAAA;AACA1B,QAAQ,CAAC4C,YAAT,GAAwBA,YAAxB,CAAA;AACA5C,QAAQ,CAAC6C,WAAT,GAAuB,UAAvB,CAAA;AACA7C,QAAQ,CAAC8C,YAAT,GAAwBC,oBAAxB;;;;"}